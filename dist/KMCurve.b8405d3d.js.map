{"version":3,"sources":["components/VisualTools/Chart/KMCurve.js","../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["_react","_interopRequireWildcard","require","d3","_propTypes","_interopRequireDefault","obj","__esModule","default","_getRequireWildcardCache","e","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","_typeof","o","Symbol","iterator","constructor","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","minLen","_arrayLikeToArray","toString","slice","name","Array","from","test","iter","isArray","len","length","arr2","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","_toPropertyKey","key","_createClass","protoProps","staticProps","arg","_toPrimitive","String","input","hint","prim","toPrimitive","undefined","res","Number","_inherits","subClass","superClass","create","value","_setPrototypeOf","p","setPrototypeOf","bind","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf","result","NewTarget","Reflect","construct","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","getPrototypeOf","isUndefined","d","toLowerCase","KMCurve","exports","_PureComponent","_super","_this","React","createRef","maxTime","NEGATIVE_INFINITY","state","margin","top","right","bottom","left","filter","data","transform","field","fields","componentDidMount","_this2","setTimeout","rect","current","getBoundingClientRect","innerWidth","width","innerHeight","height","svg","select","append","attr","viewer","concat","xScale","scaleLinear","domain","range","yScale","color","scaleOrdinal","map","quantize","interpolateSpectral","xaxisGroup","axisBottom","ticks","text","time","unit","yaxisGroup","axisLeft","forEach","drawKMCurve","nodeWidth","getBBox","legend","lg","selectAll","enter","style","offset","x","eventValue","censoredValue","group","event","filteredData","collapsed_stage","Math","max","groups","nest","entries","rs","g","risk","values","sortKeys","b","rollup","v","censor","points","currentTime","c","censored","push","drawLine","_this3","line","curve","curveStepAfter","y","datum","point","render","createElement","id","ref","PureComponent","propTypes","PropTypes","arrayOf","shape","isRequired","string","defaultProps","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","JSON","parse","type","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","every","generated","js","console","clear","hmrApply","hmrAcceptRun","reload","close","onclose","log","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","document","body","appendChild","getElementById","remove","stackTrace","innerText","innerHTML","getParents","modules","parents","k","dep","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"KMCurve.b8405d3d.js","sourceRoot":"../source","sourcesContent":["import React, { PureComponent } from 'react';\nimport * as d3 from 'd3';\nimport PropTypes from 'prop-types';\n\nfunction isUndefined(d) {\n  return d === undefined || d == null || (typeof d === 'string' && d.toLowerCase() === 'na');\n}\nexport default class KMCurve extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.self = React.createRef();\n    this.maxTime = Number.NEGATIVE_INFINITY;\n    this.state = {\n      margin: {\n        top: 35,\n        right: 20,\n        bottom: 45,\n        left: 45,\n      },\n    };\n    if (this.props.filter) {\n      this.state.data = this.transform(\n        this.props.data.filter((d) => d[this.props.filter.field] === this.props.filter.value),\n        this.props.fields,\n      );\n    } else {\n      this.state.data = this.transform(this.props.data, this.props.fields);\n    }\n  }\n\n  componentDidMount() {\n    setTimeout(() => {\n      const rect = this.self.current.getBoundingClientRect();\n      const innerWidth = rect.width - this.state.margin.left - this.state.margin.right;\n      const innerHeight = rect.height - this.state.margin.top - this.state.margin.bottom;\n      // create svg\n      const svg = d3\n        .select(this.self.current)\n        .append('svg')\n        .attr('width', rect.width)\n        .attr('height', rect.height);\n      // create viewer\n      const viewer = svg\n        .append('g')\n        .attr('transform', `translate(${this.state.margin.left},${this.state.margin.top})`);\n      //\n      this.xScale = d3.scaleLinear().domain([0, this.maxTime]).range([0, innerWidth]);\n\n      this.yScale = d3.scaleLinear().domain([0, 1]).range([innerHeight, 0]);\n\n      this.color = d3\n        .scaleOrdinal()\n        .domain(this.state.data.map((d) => d.key))\n        .range(d3.quantize((t) => d3.interpolateSpectral(t), this.state.data.length));\n\n      const xaxisGroup = viewer\n        .append('g')\n        .attr('transform', `translate(0,${innerHeight})`)\n        .call(d3.axisBottom(this.xScale).ticks(4)); // .tickSize(-innerWidth));\n      xaxisGroup\n        .append('text')\n        .attr('y', 30)\n        .attr('x', innerWidth / 2)\n        .attr('fill', 'black')\n        .attr('font-size', 13)\n        .text(`Time ${this.props.fields.time.unit ? `(${this.props.fields.time.unit})` : ''}`);\n\n      // add the y Axis\n      const yaxisGroup = viewer.append('g').call(d3.axisLeft(this.yScale).ticks(4)); // .tickSize(-innerWidth)\n      yaxisGroup\n        .append('text')\n        .attr('y', -30)\n        .attr('x', -innerHeight / 3)\n        .attr('fill', 'black')\n        .attr('font-size', 13)\n        .attr('transform', 'rotate(-90)')\n        .text('Survival Probability');\n\n      this.state.data.forEach((d) => this.drawKMCurve(viewer, d));\n\n      const height = 0;\n      const nodeWidth = (d) => d.getBBox().width;\n      const legend = svg\n        .append('g')\n        .attr('class', 'legend')\n        .attr('transform', `translate(${this.state.margin.left + innerWidth / 2},0)`);\n\n      const lg = legend\n        .selectAll('g')\n        .data(this.state.data)\n        .enter()\n        .append('g')\n        .attr('transform', (d, i) => `translate(${i * 100},${height + 15})`);\n\n      lg.append('rect')\n        .style('fill', (d) => this.color(d.key))\n        .attr('x', 0)\n        .attr('y', 0)\n        .attr('width', 10)\n        .attr('height', 10);\n\n      lg.append('text')\n        .style('font-family', 'Georgia')\n        .style('font-size', '13px')\n        .attr('x', 17.5)\n        .attr('y', 10)\n        .text((d) => d.key);\n\n      let offset = 0;\n      lg.attr('transform', function transform() {\n        const x = offset;\n        offset += nodeWidth(this) + 10;\n        return `translate(${x},${height + 10})`;\n      });\n    }, 500);\n  }\n\n  transform(data, field) {\n    const { eventValue } = field;\n    const { censoredValue } = field;\n    const group = field.group.field;\n    const time = field.time.field;\n    const event = field.event.field;\n\n    const filteredData = data.filter(\n      (d) => d.collapsed_stage !== 'stage_x/NR'\n        && !isUndefined(d[time])\n        && !isUndefined(d[event])\n        && !isUndefined(d[group]),\n    );\n    this.maxTime = Math.max(...filteredData.map((d) => d[time]));\n    const groups = d3\n      .nest()\n      .key((d) => d[group])\n      .entries(filteredData);\n    const rs = [];\n    groups.forEach((g) => {\n      const { key } = g;\n      let risk = g.values.length;\n      const values = d3\n        .nest()\n        .key((d) => +d[time])\n        .sortKeys((a, b) => +a - +b)\n        .rollup((v) => ({\n          event: v.filter((d) => d[event] === eventValue).length,\n          censor: v.filter((d) => d[event] === censoredValue).length,\n        }))\n        .entries(g.values);\n      let p = 1;\n      const points = [];\n      values.forEach((d) => {\n        const currentTime = +d.key;\n        const e = d.value.event;\n        const c = d.value.censor;\n        if (currentTime < 0) return;\n        if (e > 0) {\n          p *= 1 - e / risk;\n          const censored = false;\n          points.push({ p, currentTime, censored });\n        }\n        if (c > 0) {\n          const censored = true;\n          points.push({ p, currentTime, censored });\n        }\n        risk -= e + c;\n      });\n      rs.push({ key, points });\n    });\n\n    return rs;\n  }\n\n  drawLine(viewer, points, color) {\n    const line = d3\n      .line()\n      .curve(d3.curveStepAfter)\n      .x((d) => this.xScale(d.time))\n      .y((d) => this.yScale(d.p));\n    viewer\n      .append('path')\n      .datum(points)\n      .attr('class', 'line')\n      .style('stroke', color)\n      .attr('d', line);\n\n    points.forEach((point) => {\n      if (point.censored) {\n        const p = [\n          {\n            p: point.p - 0.015,\n            time: point.time,\n          },\n          {\n            p: point.p + 0.015,\n            time: point.time,\n          },\n        ];\n        viewer.append('path').datum(p).attr('class', 'mark').style('stroke', color)\n          .attr('d', line);\n      }\n    });\n  }\n\n  drawKMCurve(viewer, d) {\n    // draw lines\n    this.drawLine(viewer, d.points, this.color(d.key));\n    // draw marks\n  }\n\n  render() {\n    return <div id={this.props.id} ref={this.self} style={{ width: '100%', height: '100%' }} />;\n  }\n}\n\nKMCurve.propTypes = {\n  data: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  fields: PropTypes.shape({ x: PropTypes.string.isRequired, time: PropTypes.shape() }).isRequired,\n  filter: PropTypes.shape({ field: PropTypes.string, value: PropTypes.string }),\n  id: PropTypes.string.isRequired,\n};\n\nKMCurve.defaultProps = {\n  filter: {},\n};\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}