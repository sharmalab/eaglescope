function e(e){return e&&e.__esModule?e.default:e}var t=globalThis.parcelRequire94c2;(0,t.register)("lSqO9",function(r,a){Object.defineProperty(r.exports,"__esModule",{value:!0,configurable:!0}),Object.defineProperty(r.exports,"default",{get:()=>c,set:void 0,enumerable:!0,configurable:!0});var i=t("ayMG0"),n=t("acw62"),l=t("9NlP8"),s=t("c9Z8w"),u=t("63tWu");function d(e){let t=[0,0],r=[0,0],a=(0,n.useRef)(),s=(0,n.useRef)(),d=(0,n.useRef)({x:l.scaleLinear(),y:l.scaleLinear()}),c=()=>{if(!l.event.selection)return;let[a,i]=[Math.min(t[0],r[0]),Math.min(t[1],r[1])],[n,s]=[Math.max(t[0],r[0]),Math.max(t[1],r[1])],c=[{id:`${e.id}_x`,title:e.title,field:e.fields.x,operation:"range",values:[(0,u.numFixed)(d.current.x.invert(a)),(0,u.numFixed)(d.current.x.invert(n))]},{id:`${e.id}_y`,title:e.title,field:e.fields.y,operation:"range",values:[(0,u.numFixed)(d.current.y.invert(s)),(0,u.numFixed)(d.current.y.invert(i))]}];e.filterAdded(c)};return(0,n.useEffect)(()=>{setTimeout(()=>{l.select(a.current).selectAll("svg").remove("svg");let i=a.current.getBoundingClientRect(),n=i.width-40-30,u=i.height-10-20;s.current=l.select(a.current).append("svg").attr("width",i.width).attr("height",i.height).append("g").attr("transform","translate(40,10)");let o=l.extent(e.data,t=>t[e.fields.x]),h=(o[1]-o[0])*.1,f=l.extent(e.data,t=>t[e.fields.y]),g=(f[1]-f[0])*.1;d.current.x.domain([o[0]-h,o[1]+h]).range([0,n]),d.current.y.domain([f[0]-g,f[1]+g]).range([u,0]),s.current.append("g").attr("transform",`translate(0,${u})`).call(l.axisBottom(d.current.x)),s.current.append("g").call(l.axisLeft(d.current.y));let p=()=>{let e=s.current.select(".overlay").node();return[l.event.sourceEvent.clientX-e.getBoundingClientRect().x,l.event.sourceEvent.clientY-e.getBoundingClientRect().y]},m=l.brush().extent([[0,0],[n,u]]).on("start",()=>{t=p(),s.current.selectAll(".selection").remove("rect")}).on("brush",()=>{r=p(),s.current.selectAll(".selected-area").remove(".selected-area"),s.current.selectAll(".selection").remove("rect");let e=Math.min(t[0],r[0]),a=Math.min(t[1],r[1]);s.current.append("rect").attr("class","selected-area").attr("position","absolute").attr("x",e).attr("y",a).attr("width",Math.abs(r[0]-t[0])).attr("height",Math.abs(r[1]-t[1])).attr("fill","rgba(130, 130, 130, 0.5)")}).on("end",()=>{r=p(),s.current.selectAll(".selected-area").remove(".selected-area"),s.current.selectAll(".selection").remove("rect");let e=Math.min(t[0],r[0]),a=Math.min(t[1],r[1]),i=s.current.append("rect").attr("class","selected-area").attr("position","absolute").attr("x",e).attr("y",a).attr("width",Math.abs(r[0]-t[0])).attr("height",Math.abs(r[1]-t[1])).attr("fill","rgba(140, 140, 140, 0.5)");c(),setTimeout(()=>{i.remove()},20)});s.current.append("g").call(m)},100)},[e.layout]),(0,n.useEffect)(()=>{setTimeout(()=>{let t=a.current.getBoundingClientRect(),r=t.width-40-30,i=t.height-10-20,{data:n}=e;0!==e.filters.length&&(n=e.filterData);let u=10**(-4+Math.round(Math.log10(n.length))),c=l.scaleLinear().domain([0,u]).range(["white","#4682b4"]),o=l.contourDensity().x(t=>d.current.x(t[e.fields.x])).y(t=>d.current.y(t[e.fields.y])).size([r,i]).bandwidth(20)(n);s.current.select("#draw_area").remove("g"),s.current.insert("g","g").attr("id","draw_area").selectAll("path").data(o).enter().append("path").attr("d",l.geoPath()).attr("fill",e=>c(e.value))},100)},[e.layout,e.filters,e.filterData]),(0,i.jsx)("div",{id:e.id,ref:a,role:"figure",style:{width:"100%",height:"100%"}})}var c=d;d.propTypes={data:e(s).arrayOf(e(s).shape({})).isRequired,fields:e(s).shape({x:e(s).string.isRequired,y:e(s).string.isRequired}).isRequired,id:e(s).string.isRequired,filterData:e(s).arrayOf(e(s).shape({})).isRequired,filters:e(s).arrayOf(e(s).shape({})).isRequired,layout:e(s).shape({width:e(s).number.isRequired,currentCols:e(s).number.isRequired}).isRequired,filterAdded:e(s).func.isRequired,title:e(s).string.isRequired}});
//# sourceMappingURL=DensityChart.9b9ea629.js.map
