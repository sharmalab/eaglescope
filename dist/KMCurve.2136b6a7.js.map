{"mappings":"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","sources":["<anon>","source/components/VisualTools/Chart/KMCurve.js"],"sourcesContent":["\n      var $parcel$global = globalThis;\n    var parcelRequire = $parcel$global[\"parcelRequire94c2\"];\nvar parcelRegister = parcelRequire.register;\nparcelRegister(\"3qdiD\", function(module, exports) {\n\"use strict\";\nfunction $27de1dd5e4f9ba3a$var$_typeof(o) {\n    \"@babel/helpers - typeof\";\n    return $27de1dd5e4f9ba3a$var$_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function(o) {\n        return typeof o;\n    } : function(o) {\n        return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n    }, $27de1dd5e4f9ba3a$var$_typeof(o);\n}\nObject.defineProperty(module.exports, \"__esModule\", {\n    value: true\n});\nmodule.exports[\"default\"] = void 0;\n\nvar $27de1dd5e4f9ba3a$var$_react = $27de1dd5e4f9ba3a$var$_interopRequireWildcard((parcelRequire(\"acw62\")));\n\nvar $27de1dd5e4f9ba3a$var$d3 = $27de1dd5e4f9ba3a$var$_interopRequireWildcard((parcelRequire(\"9NlP8\")));\n\nvar $27de1dd5e4f9ba3a$var$_propTypes = $27de1dd5e4f9ba3a$var$_interopRequireDefault((parcelRequire(\"c9Z8w\")));\nfunction $27de1dd5e4f9ba3a$var$_interopRequireDefault(e) {\n    return e && e.__esModule ? e : {\n        \"default\": e\n    };\n}\nfunction $27de1dd5e4f9ba3a$var$_getRequireWildcardCache(e) {\n    if (\"function\" != typeof WeakMap) return null;\n    var r = new WeakMap(), t = new WeakMap();\n    return ($27de1dd5e4f9ba3a$var$_getRequireWildcardCache = function _getRequireWildcardCache(e) {\n        return e ? t : r;\n    })(e);\n}\nfunction $27de1dd5e4f9ba3a$var$_interopRequireWildcard(e, r) {\n    if (!r && e && e.__esModule) return e;\n    if (null === e || \"object\" != $27de1dd5e4f9ba3a$var$_typeof(e) && \"function\" != typeof e) return {\n        \"default\": e\n    };\n    var t = $27de1dd5e4f9ba3a$var$_getRequireWildcardCache(r);\n    if (t && t.has(e)) return t.get(e);\n    var n = {\n        __proto__: null\n    }, a = Object.defineProperty && Object.getOwnPropertyDescriptor;\n    for(var u in e)if (\"default\" !== u && ({}).hasOwnProperty.call(e, u)) {\n        var i = a ? Object.getOwnPropertyDescriptor(e, u) : null;\n        i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u];\n    }\n    return n[\"default\"] = e, t && t.set(e, n), n;\n}\nfunction $27de1dd5e4f9ba3a$var$_toConsumableArray(r) {\n    return $27de1dd5e4f9ba3a$var$_arrayWithoutHoles(r) || $27de1dd5e4f9ba3a$var$_iterableToArray(r) || $27de1dd5e4f9ba3a$var$_unsupportedIterableToArray(r) || $27de1dd5e4f9ba3a$var$_nonIterableSpread();\n}\nfunction $27de1dd5e4f9ba3a$var$_nonIterableSpread() {\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction $27de1dd5e4f9ba3a$var$_unsupportedIterableToArray(r, a) {\n    if (r) {\n        if (\"string\" == typeof r) return $27de1dd5e4f9ba3a$var$_arrayLikeToArray(r, a);\n        var t = ({}).toString.call(r).slice(8, -1);\n        return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? $27de1dd5e4f9ba3a$var$_arrayLikeToArray(r, a) : void 0;\n    }\n}\nfunction $27de1dd5e4f9ba3a$var$_iterableToArray(r) {\n    if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r);\n}\nfunction $27de1dd5e4f9ba3a$var$_arrayWithoutHoles(r) {\n    if (Array.isArray(r)) return $27de1dd5e4f9ba3a$var$_arrayLikeToArray(r);\n}\nfunction $27de1dd5e4f9ba3a$var$_arrayLikeToArray(r, a) {\n    (null == a || a > r.length) && (a = r.length);\n    for(var e = 0, n = Array(a); e < a; e++)n[e] = r[e];\n    return n;\n}\nfunction $27de1dd5e4f9ba3a$var$_classCallCheck(a, n) {\n    if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\");\n}\nfunction $27de1dd5e4f9ba3a$var$_defineProperties(e, r) {\n    for(var t = 0; t < r.length; t++){\n        var o = r[t];\n        o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, $27de1dd5e4f9ba3a$var$_toPropertyKey(o.key), o);\n    }\n}\nfunction $27de1dd5e4f9ba3a$var$_createClass(e, r, t) {\n    return r && $27de1dd5e4f9ba3a$var$_defineProperties(e.prototype, r), t && $27de1dd5e4f9ba3a$var$_defineProperties(e, t), Object.defineProperty(e, \"prototype\", {\n        writable: !1\n    }), e;\n}\nfunction $27de1dd5e4f9ba3a$var$_toPropertyKey(t) {\n    var i = $27de1dd5e4f9ba3a$var$_toPrimitive(t, \"string\");\n    return \"symbol\" == $27de1dd5e4f9ba3a$var$_typeof(i) ? i : i + \"\";\n}\nfunction $27de1dd5e4f9ba3a$var$_toPrimitive(t, r) {\n    if (\"object\" != $27de1dd5e4f9ba3a$var$_typeof(t) || !t) return t;\n    var e = t[Symbol.toPrimitive];\n    if (void 0 !== e) {\n        var i = e.call(t, r || \"default\");\n        if (\"object\" != $27de1dd5e4f9ba3a$var$_typeof(i)) return i;\n        throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n    }\n    return (\"string\" === r ? String : Number)(t);\n}\nfunction $27de1dd5e4f9ba3a$var$_callSuper(t, o, e) {\n    return o = $27de1dd5e4f9ba3a$var$_getPrototypeOf(o), $27de1dd5e4f9ba3a$var$_possibleConstructorReturn(t, $27de1dd5e4f9ba3a$var$_isNativeReflectConstruct() ? Reflect.construct(o, e || [], $27de1dd5e4f9ba3a$var$_getPrototypeOf(t).constructor) : o.apply(t, e));\n}\nfunction $27de1dd5e4f9ba3a$var$_possibleConstructorReturn(t, e) {\n    if (e && (\"object\" == $27de1dd5e4f9ba3a$var$_typeof(e) || \"function\" == typeof e)) return e;\n    if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\");\n    return $27de1dd5e4f9ba3a$var$_assertThisInitialized(t);\n}\nfunction $27de1dd5e4f9ba3a$var$_assertThisInitialized(e) {\n    if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    return e;\n}\nfunction $27de1dd5e4f9ba3a$var$_isNativeReflectConstruct() {\n    try {\n        var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {}));\n    } catch (t) {}\n    return ($27de1dd5e4f9ba3a$var$_isNativeReflectConstruct = function _isNativeReflectConstruct() {\n        return !!t;\n    })();\n}\nfunction $27de1dd5e4f9ba3a$var$_getPrototypeOf(t) {\n    return $27de1dd5e4f9ba3a$var$_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function(t) {\n        return t.__proto__ || Object.getPrototypeOf(t);\n    }, $27de1dd5e4f9ba3a$var$_getPrototypeOf(t);\n}\nfunction $27de1dd5e4f9ba3a$var$_inherits(t, e) {\n    if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\");\n    t.prototype = Object.create(e && e.prototype, {\n        constructor: {\n            value: t,\n            writable: !0,\n            configurable: !0\n        }\n    }), Object.defineProperty(t, \"prototype\", {\n        writable: !1\n    }), e && $27de1dd5e4f9ba3a$var$_setPrototypeOf(t, e);\n}\nfunction $27de1dd5e4f9ba3a$var$_setPrototypeOf(t, e) {\n    return $27de1dd5e4f9ba3a$var$_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function(t, e) {\n        return t.__proto__ = e, t;\n    }, $27de1dd5e4f9ba3a$var$_setPrototypeOf(t, e);\n}\nfunction $27de1dd5e4f9ba3a$var$isUndefined(d) {\n    return d === undefined || d == null || typeof d === 'string' && d.toLowerCase() === 'na';\n}\nvar $27de1dd5e4f9ba3a$var$KMCurve = module.exports[\"default\"] = /*#__PURE__*/ function(_PureComponent) {\n    function KMCurve(props) {\n        var _this;\n        $27de1dd5e4f9ba3a$var$_classCallCheck(this, KMCurve);\n        _this = $27de1dd5e4f9ba3a$var$_callSuper(this, KMCurve, [\n            props\n        ]);\n        _this.self = /*#__PURE__*/ $27de1dd5e4f9ba3a$var$_react[\"default\"].createRef();\n        _this.maxTime = Number.NEGATIVE_INFINITY;\n        _this.state = {\n            margin: {\n                top: 35,\n                right: 20,\n                bottom: 45,\n                left: 45\n            }\n        };\n        if (_this.props.filter) _this.state.data = _this.transform(_this.props.data.filter(function(d) {\n            return d[_this.props.filter.field] === _this.props.filter.value;\n        }), _this.props.fields);\n        else _this.state.data = _this.transform(_this.props.data, _this.props.fields);\n        return _this;\n    }\n    $27de1dd5e4f9ba3a$var$_inherits(KMCurve, _PureComponent);\n    return $27de1dd5e4f9ba3a$var$_createClass(KMCurve, [\n        {\n            key: \"componentDidMount\",\n            value: function componentDidMount() {\n                var _this2 = this;\n                setTimeout(function() {\n                    var rect = _this2.self.current.getBoundingClientRect();\n                    var innerWidth = rect.width - _this2.state.margin.left - _this2.state.margin.right;\n                    var innerHeight = rect.height - _this2.state.margin.top - _this2.state.margin.bottom;\n                    // create svg\n                    var svg = $27de1dd5e4f9ba3a$var$d3.select(_this2.self.current).append('svg').attr('width', rect.width).attr('height', rect.height);\n                    // create viewer\n                    var viewer = svg.append('g').attr('transform', \"translate(\".concat(_this2.state.margin.left, \",\").concat(_this2.state.margin.top, \")\"));\n                    //\n                    _this2.xScale = $27de1dd5e4f9ba3a$var$d3.scaleLinear().domain([\n                        0,\n                        _this2.maxTime\n                    ]).range([\n                        0,\n                        innerWidth\n                    ]);\n                    _this2.yScale = $27de1dd5e4f9ba3a$var$d3.scaleLinear().domain([\n                        0,\n                        1\n                    ]).range([\n                        innerHeight,\n                        0\n                    ]);\n                    _this2.color = $27de1dd5e4f9ba3a$var$d3.scaleOrdinal().domain(_this2.state.data.map(function(d) {\n                        return d.key;\n                    })).range($27de1dd5e4f9ba3a$var$d3.quantize(function(t) {\n                        return $27de1dd5e4f9ba3a$var$d3.interpolateSpectral(t);\n                    }, _this2.state.data.length));\n                    var xaxisGroup = viewer.append('g').attr('transform', \"translate(0,\".concat(innerHeight, \")\")).call($27de1dd5e4f9ba3a$var$d3.axisBottom(_this2.xScale).ticks(4)); // .tickSize(-innerWidth));\n                    xaxisGroup.append('text').attr('y', 30).attr('x', innerWidth / 2).attr('fill', 'black').attr('font-size', 13).text(\"Time \".concat(_this2.props.fields.time.unit ? \"(\".concat(_this2.props.fields.time.unit, \")\") : ''));\n                    // add the y Axis\n                    var yaxisGroup = viewer.append('g').call($27de1dd5e4f9ba3a$var$d3.axisLeft(_this2.yScale).ticks(4)); // .tickSize(-innerWidth)\n                    yaxisGroup.append('text').attr('y', -30).attr('x', -innerHeight / 3).attr('fill', 'black').attr('font-size', 13).attr('transform', 'rotate(-90)').text('Survival Probability');\n                    _this2.state.data.forEach(function(d) {\n                        return _this2.drawKMCurve(viewer, d);\n                    });\n                    var height = 0;\n                    var nodeWidth = function nodeWidth(d) {\n                        return d.getBBox().width;\n                    };\n                    var legend = svg.append('g').attr('class', 'legend').attr('transform', \"translate(\".concat(_this2.state.margin.left + innerWidth / 2, \",0)\"));\n                    var lg = legend.selectAll('g').data(_this2.state.data).enter().append('g').attr('transform', function(d, i) {\n                        return \"translate(\".concat(i * 100, \",\").concat(height + 15, \")\");\n                    });\n                    lg.append('rect').style('fill', function(d) {\n                        return _this2.color(d.key);\n                    }).attr('x', 0).attr('y', 0).attr('width', 10).attr('height', 10);\n                    lg.append('text').style('font-family', 'Georgia').style('font-size', '13px').attr('x', 17.5).attr('y', 10).text(function(d) {\n                        return d.key;\n                    });\n                    var offset = 0;\n                    lg.attr('transform', function transform() {\n                        var x = offset;\n                        offset += nodeWidth(this) + 10;\n                        return \"translate(\".concat(x, \",\").concat(height + 10, \")\");\n                    });\n                }, 500);\n            }\n        },\n        {\n            key: \"transform\",\n            value: function transform(data, field) {\n                var eventValue = field.eventValue;\n                var censoredValue = field.censoredValue;\n                var group = field.group.field;\n                var time = field.time.field;\n                var event = field.event.field;\n                var filteredData = data.filter(function(d) {\n                    return d.collapsed_stage !== 'stage_x/NR' && !$27de1dd5e4f9ba3a$var$isUndefined(d[time]) && !$27de1dd5e4f9ba3a$var$isUndefined(d[event]) && !$27de1dd5e4f9ba3a$var$isUndefined(d[group]);\n                });\n                this.maxTime = Math.max.apply(Math, $27de1dd5e4f9ba3a$var$_toConsumableArray(filteredData.map(function(d) {\n                    return d[time];\n                })));\n                var groups = $27de1dd5e4f9ba3a$var$d3.nest().key(function(d) {\n                    return d[group];\n                }).entries(filteredData);\n                var rs = [];\n                groups.forEach(function(g) {\n                    var key = g.key;\n                    var risk = g.values.length;\n                    var values = $27de1dd5e4f9ba3a$var$d3.nest().key(function(d) {\n                        return +d[time];\n                    }).sortKeys(function(a, b) {\n                        return +a - +b;\n                    }).rollup(function(v) {\n                        return {\n                            event: v.filter(function(d) {\n                                return d[event] === eventValue;\n                            }).length,\n                            censor: v.filter(function(d) {\n                                return d[event] === censoredValue;\n                            }).length\n                        };\n                    }).entries(g.values);\n                    var p = 1;\n                    var points = [];\n                    values.forEach(function(d) {\n                        var currentTime = +d.key;\n                        var e = d.value.event;\n                        var c = d.value.censor;\n                        if (currentTime < 0) return;\n                        if (e > 0) {\n                            p *= 1 - e / risk;\n                            var censored = false;\n                            points.push({\n                                p: p,\n                                currentTime: currentTime,\n                                censored: censored\n                            });\n                        }\n                        if (c > 0) {\n                            var _censored = true;\n                            points.push({\n                                p: p,\n                                currentTime: currentTime,\n                                censored: _censored\n                            });\n                        }\n                        risk -= e + c;\n                    });\n                    rs.push({\n                        key: key,\n                        points: points\n                    });\n                });\n                return rs;\n            }\n        },\n        {\n            key: \"drawLine\",\n            value: function drawLine(viewer, points, color) {\n                var _this3 = this;\n                var line = $27de1dd5e4f9ba3a$var$d3.line().curve($27de1dd5e4f9ba3a$var$d3.curveStepAfter).x(function(d) {\n                    return _this3.xScale(d.time);\n                }).y(function(d) {\n                    return _this3.yScale(d.p);\n                });\n                viewer.append('path').datum(points).attr('class', 'line').style('stroke', color).attr('d', line);\n                points.forEach(function(point) {\n                    if (point.censored) {\n                        var p = [\n                            {\n                                p: point.p - 0.015,\n                                time: point.time\n                            },\n                            {\n                                p: point.p + 0.015,\n                                time: point.time\n                            }\n                        ];\n                        viewer.append('path').datum(p).attr('class', 'mark').style('stroke', color).attr('d', line);\n                    }\n                });\n            }\n        },\n        {\n            key: \"drawKMCurve\",\n            value: function drawKMCurve(viewer, d) {\n                // draw lines\n                this.drawLine(viewer, d.points, this.color(d.key));\n            // draw marks\n            }\n        },\n        {\n            key: \"render\",\n            value: function render() {\n                return /*#__PURE__*/ $27de1dd5e4f9ba3a$var$_react[\"default\"].createElement(\"div\", {\n                    id: this.props.id,\n                    ref: this.self,\n                    role: \"figure\",\n                    style: {\n                        width: '100%',\n                        height: '100%'\n                    }\n                });\n            }\n        }\n    ]);\n}($27de1dd5e4f9ba3a$var$_react.PureComponent);\n$27de1dd5e4f9ba3a$var$KMCurve.propTypes = {\n    data: $27de1dd5e4f9ba3a$var$_propTypes[\"default\"].arrayOf($27de1dd5e4f9ba3a$var$_propTypes[\"default\"].shape({})).isRequired,\n    fields: $27de1dd5e4f9ba3a$var$_propTypes[\"default\"].shape({\n        x: $27de1dd5e4f9ba3a$var$_propTypes[\"default\"].string.isRequired,\n        time: $27de1dd5e4f9ba3a$var$_propTypes[\"default\"].shape()\n    }).isRequired,\n    filter: $27de1dd5e4f9ba3a$var$_propTypes[\"default\"].shape({\n        field: $27de1dd5e4f9ba3a$var$_propTypes[\"default\"].string,\n        value: $27de1dd5e4f9ba3a$var$_propTypes[\"default\"].string\n    }),\n    id: $27de1dd5e4f9ba3a$var$_propTypes[\"default\"].string.isRequired\n};\n$27de1dd5e4f9ba3a$var$KMCurve.defaultProps = {\n    filter: {}\n};\n\n});\n\n\n//# sourceMappingURL=KMCurve.2136b6a7.js.map\n","import React, { PureComponent } from 'react';\nimport * as d3 from 'd3';\nimport PropTypes from 'prop-types';\n\nfunction isUndefined(d) {\n  return d === undefined || d == null || (typeof d === 'string' && d.toLowerCase() === 'na');\n}\nexport default class KMCurve extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.self = React.createRef();\n    this.maxTime = Number.NEGATIVE_INFINITY;\n    this.state = {\n      margin: {\n        top: 35,\n        right: 20,\n        bottom: 45,\n        left: 45,\n      },\n    };\n    if (this.props.filter) {\n      this.state.data = this.transform(\n        this.props.data.filter((d) => d[this.props.filter.field] === this.props.filter.value),\n        this.props.fields,\n      );\n    } else {\n      this.state.data = this.transform(this.props.data, this.props.fields);\n    }\n  }\n\n  componentDidMount() {\n    setTimeout(() => {\n      const rect = this.self.current.getBoundingClientRect();\n      const innerWidth = rect.width - this.state.margin.left - this.state.margin.right;\n      const innerHeight = rect.height - this.state.margin.top - this.state.margin.bottom;\n      // create svg\n      const svg = d3\n        .select(this.self.current)\n        .append('svg')\n        .attr('width', rect.width)\n        .attr('height', rect.height);\n      // create viewer\n      const viewer = svg\n        .append('g')\n        .attr('transform', `translate(${this.state.margin.left},${this.state.margin.top})`);\n      //\n      this.xScale = d3.scaleLinear().domain([0, this.maxTime]).range([0, innerWidth]);\n\n      this.yScale = d3.scaleLinear().domain([0, 1]).range([innerHeight, 0]);\n\n      this.color = d3\n        .scaleOrdinal()\n        .domain(this.state.data.map((d) => d.key))\n        .range(d3.quantize((t) => d3.interpolateSpectral(t), this.state.data.length));\n\n      const xaxisGroup = viewer\n        .append('g')\n        .attr('transform', `translate(0,${innerHeight})`)\n        .call(d3.axisBottom(this.xScale).ticks(4)); // .tickSize(-innerWidth));\n      xaxisGroup\n        .append('text')\n        .attr('y', 30)\n        .attr('x', innerWidth / 2)\n        .attr('fill', 'black')\n        .attr('font-size', 13)\n        .text(`Time ${this.props.fields.time.unit ? `(${this.props.fields.time.unit})` : ''}`);\n\n      // add the y Axis\n      const yaxisGroup = viewer.append('g').call(d3.axisLeft(this.yScale).ticks(4)); // .tickSize(-innerWidth)\n      yaxisGroup\n        .append('text')\n        .attr('y', -30)\n        .attr('x', -innerHeight / 3)\n        .attr('fill', 'black')\n        .attr('font-size', 13)\n        .attr('transform', 'rotate(-90)')\n        .text('Survival Probability');\n\n      this.state.data.forEach((d) => this.drawKMCurve(viewer, d));\n\n      const height = 0;\n      const nodeWidth = (d) => d.getBBox().width;\n      const legend = svg\n        .append('g')\n        .attr('class', 'legend')\n        .attr('transform', `translate(${this.state.margin.left + innerWidth / 2},0)`);\n\n      const lg = legend\n        .selectAll('g')\n        .data(this.state.data)\n        .enter()\n        .append('g')\n        .attr('transform', (d, i) => `translate(${i * 100},${height + 15})`);\n\n      lg.append('rect')\n        .style('fill', (d) => this.color(d.key))\n        .attr('x', 0)\n        .attr('y', 0)\n        .attr('width', 10)\n        .attr('height', 10);\n\n      lg.append('text')\n        .style('font-family', 'Georgia')\n        .style('font-size', '13px')\n        .attr('x', 17.5)\n        .attr('y', 10)\n        .text((d) => d.key);\n\n      let offset = 0;\n      lg.attr('transform', function transform() {\n        const x = offset;\n        offset += nodeWidth(this) + 10;\n        return `translate(${x},${height + 10})`;\n      });\n    }, 500);\n  }\n\n  transform(data, field) {\n    const { eventValue } = field;\n    const { censoredValue } = field;\n    const group = field.group.field;\n    const time = field.time.field;\n    const event = field.event.field;\n\n    const filteredData = data.filter(\n      (d) => d.collapsed_stage !== 'stage_x/NR'\n        && !isUndefined(d[time])\n        && !isUndefined(d[event])\n        && !isUndefined(d[group]),\n    );\n    this.maxTime = Math.max(...filteredData.map((d) => d[time]));\n    const groups = d3\n      .nest()\n      .key((d) => d[group])\n      .entries(filteredData);\n    const rs = [];\n    groups.forEach((g) => {\n      const { key } = g;\n      let risk = g.values.length;\n      const values = d3\n        .nest()\n        .key((d) => +d[time])\n        .sortKeys((a, b) => +a - +b)\n        .rollup((v) => ({\n          event: v.filter((d) => d[event] === eventValue).length,\n          censor: v.filter((d) => d[event] === censoredValue).length,\n        }))\n        .entries(g.values);\n      let p = 1;\n      const points = [];\n      values.forEach((d) => {\n        const currentTime = +d.key;\n        const e = d.value.event;\n        const c = d.value.censor;\n        if (currentTime < 0) return;\n        if (e > 0) {\n          p *= 1 - e / risk;\n          const censored = false;\n          points.push({ p, currentTime, censored });\n        }\n        if (c > 0) {\n          const censored = true;\n          points.push({ p, currentTime, censored });\n        }\n        risk -= e + c;\n      });\n      rs.push({ key, points });\n    });\n\n    return rs;\n  }\n\n  drawLine(viewer, points, color) {\n    const line = d3\n      .line()\n      .curve(d3.curveStepAfter)\n      .x((d) => this.xScale(d.time))\n      .y((d) => this.yScale(d.p));\n    viewer\n      .append('path')\n      .datum(points)\n      .attr('class', 'line')\n      .style('stroke', color)\n      .attr('d', line);\n\n    points.forEach((point) => {\n      if (point.censored) {\n        const p = [\n          {\n            p: point.p - 0.015,\n            time: point.time,\n          },\n          {\n            p: point.p + 0.015,\n            time: point.time,\n          },\n        ];\n        viewer.append('path').datum(p).attr('class', 'mark').style('stroke', color)\n          .attr('d', line);\n      }\n    });\n  }\n\n  drawKMCurve(viewer, d) {\n    // draw lines\n    this.drawLine(viewer, d.points, this.color(d.key));\n    // draw marks\n  }\n\n  render() {\n    return <div id={this.props.id} ref={this.self} role=\"figure\" style={{ width: '100%', height: '100%' }} />;\n  }\n}\n\nKMCurve.propTypes = {\n  data: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  fields: PropTypes.shape({ x: PropTypes.string.isRequired, time: PropTypes.shape() }).isRequired,\n  filter: PropTypes.shape({ field: PropTypes.string, value: PropTypes.string }),\n  id: PropTypes.string.isRequired,\n};\n\nKMCurve.defaultProps = {\n  filter: {},\n};\n"],"names":["parcelRequire","$parcel$global","globalThis","parcelRegister","register","module","exports","$27de1dd5e4f9ba3a$var$_typeof","o","Symbol","iterator","constructor","prototype","Object","defineProperty","value","e","$27de1dd5e4f9ba3a$var$_react","$27de1dd5e4f9ba3a$var$_interopRequireWildcard","$27de1dd5e4f9ba3a$var$d3","$27de1dd5e4f9ba3a$var$_propTypes","__esModule","$27de1dd5e4f9ba3a$var$_getRequireWildcardCache","WeakMap","r","t","has","get","n","__proto__","a","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","$27de1dd5e4f9ba3a$var$_arrayLikeToArray","length","Array","$27de1dd5e4f9ba3a$var$_isNativeReflectConstruct","Boolean","valueOf","Reflect","construct","$27de1dd5e4f9ba3a$var$_getPrototypeOf","setPrototypeOf","getPrototypeOf","bind","$27de1dd5e4f9ba3a$var$_setPrototypeOf","$27de1dd5e4f9ba3a$var$isUndefined","d","undefined","toLowerCase","$27de1dd5e4f9ba3a$var$KMCurve","_PureComponent","KMCurve","props","_this","$27de1dd5e4f9ba3a$var$_classCallCheck","TypeError","$27de1dd5e4f9ba3a$var$_possibleConstructorReturn","$27de1dd5e4f9ba3a$var$_assertThisInitialized","ReferenceError","apply","self","createRef","maxTime","Number","NEGATIVE_INFINITY","state","margin","top","right","bottom","left","filter","data","transform","field","fields","$27de1dd5e4f9ba3a$var$_inherits","create","writable","configurable","key","_this2","setTimeout","rect","current","getBoundingClientRect","innerWidth","width","innerHeight","height","svg","select","append","attr","viewer","concat","xScale","scaleLinear","domain","range","yScale","color","scaleOrdinal","map","quantize","interpolateSpectral","xaxisGroup","axisBottom","ticks","text","time","unit","yaxisGroup","axisLeft","forEach","drawKMCurve","lg","legend","selectAll","enter","style","offset","x","nodeWidth","getBBox","eventValue","censoredValue","group","event","filteredData","collapsed_stage","Math","max","$27de1dd5e4f9ba3a$var$_arrayWithoutHoles","isArray","$27de1dd5e4f9ba3a$var$_iterableToArray","from","$27de1dd5e4f9ba3a$var$_unsupportedIterableToArray","toString","slice","name","test","$27de1dd5e4f9ba3a$var$_nonIterableSpread","groups","nest","entries","rs","g","risk","values","sortKeys","b","rollup","v","censor","p","points","currentTime","c","push","censored","_this3","line","curve","curveStepAfter","y","datum","point","drawLine","createElement","id","ref","role","$27de1dd5e4f9ba3a$var$_defineProperties","enumerable","$27de1dd5e4f9ba3a$var$_toPropertyKey","$27de1dd5e4f9ba3a$var$_toPrimitive","toPrimitive","String","PureComponent","propTypes","arrayOf","shape","isRequired","string","defaultProps","_react","_interopRequireWildcard","require","d3","_propTypes","_interopRequireDefault","_getRequireWildcardCache","_typeof","_toConsumableArray","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","_arrayLikeToArray","_classCallCheck","_defineProperties","_toPropertyKey","_createClass","_toPrimitive","_callSuper","_getPrototypeOf","_possibleConstructorReturn","_isNativeReflectConstruct","_assertThisInitialized","_inherits","_setPrototypeOf","isUndefined","React","componentDidMount","render","PropTypes"],"version":3,"file":"KMCurve.2136b6a7.js.map"}