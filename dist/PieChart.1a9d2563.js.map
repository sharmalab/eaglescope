{"mappings":"A,S,E,C,E,O,G,E,U,C,E,O,C,C,C,S,E,C,C,C,C,C,C,C,E,O,c,C,E,E,C,I,E,I,E,W,C,E,a,C,C,E,C,I,E,A,W,iB,C,E,E,Q,C,E,Q,S,C,C,C,E,O,c,C,E,O,C,a,C,M,C,E,a,C,C,G,E,E,O,C,U,I,G,I,E,E,S,E,E,S,E,E,S,E,E,S,E,E,SCKA,SAAS,EAAS,CAAK,EACrB,IAAM,EAAO,AAAA,CAAA,EAAA,EAAA,MAAK,AAAL,IAOP,EAAO,EAAA,IAAA,GAEV,GAAG,CAAC,AAAC,GAAM,CAAC,CAAC,EAAM,MAAM,CAAC,CAAC,CAAC,EAE5B,MAAM,CAAC,AAAC,GAAM,EAAE,MAAM,EACtB,OAAO,CAAC,EAAM,IAAI,EAEf,EAAM,EAAA,GAAA,CAAO,EAAM,AAAC,GAAM,EAAE,KAAK,EAMjC,EAAO,AALD,EAAA,GAAA,GAET,UAAU,CAAC,CAAC,EAAG,IAAM,EAAI,GACzB,KAAK,CAAC,AAAC,GAAM,EAAE,KAAK,EAEN,GA6HjB,MA3HA,AAAA,CAAA,EAAA,EAAA,SAAQ,AAAR,EAAU,KACR,WAAW,KAET,EAAA,MAAA,CAAU,EAAK,OAAO,EAAE,MAAM,CAAC,YAAY,MAAM,CAAC,YAClD,EAAA,MAAA,CAAU,EAAK,OAAO,EAAE,SAAS,CAAC,OAAO,MAAM,CAAC,OAGhD,IAAM,EAAO,EAAK,OAAO,CAAC,qBAAqB,GACzC,EAAa,EAAK,KAAK,CAzBzB,EAFC,EA4BC,EAAc,EAAK,MAAM,CA7B5B,EAEG,EA4BA,EAAS,KAAK,GAAG,CAAC,EAAY,GAAe,EAE7C,EAAM,EAAA,GAAA,GAAS,WAAW,CAAC,GAAG,WAAW,CAAC,GAE1C,EAAQ,EAAA,YAAA,GAEX,MAAM,CAAC,EAAK,GAAG,CAAC,AAAC,GAAM,EAAE,GAAG,GAC5B,KAAK,CAAC,EAAA,QAAA,CAAY,AAAC,GAAM,EAAA,mBAAA,CAAuB,GAAI,EAAK,MAAM,GAE5D,EAAM,EAAA,MAAA,CACF,EAAK,OAAO,EACnB,MAAM,CAAC,OACP,IAAI,CAAC,QAAS,EAAK,KAAK,EACxB,IAAI,CAAC,SAAU,EAAK,MAAM,EAEvB,EAAS,EACZ,MAAM,CAAC,KACP,IAAI,CACH,YACA,CAAC,UAAU,EAAE,EAAa,EA9C1B,EA8C0C,CAAC,EAAE,EAAc,EAjD5D,EAiD2E,CAAC,CAAC,EAGhF,GAAI,EAAa,IAAK,CACpB,IAAM,EAAU,EACb,SAAS,CAAC,WACV,IAAI,CAAC,GACL,KAAK,GACL,MAAM,CAAC,KACP,IAAI,CAAC,YAAa,CAAC,EAAG,IAAM,CAAC,UAAU,EAAE,EAAa,IAAI,CAAC,EAAE,AAAI,GAAJ,EAAS,GAAG,CAAC,CAAC,EAC3E,IAAI,CAAC,QAAS,UAEjB,EACG,MAAM,CAAC,QACP,IAAI,CAAC,QAAS,IACd,IAAI,CAAC,SAAU,IACf,IAAI,CAAC,OAAQ,CAAC,EAAG,IAAM,EAAM,IAC7B,IAAI,CAAC,SAAU,QACf,KAAK,CAAC,eAAgB,OAEzB,EACG,MAAM,CAAC,QACP,IAAI,CAAC,AAAC,GAAM,CAAA,EAAG,EAAE,KAAK,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC,GAAG,CAAA,CAAE,EACvC,KAAK,CAAC,YAAa,IACnB,IAAI,CAAC,IAAK,IACV,IAAI,CAAC,IAAK,GACf,CAKA,IAAM,EAAS,CACb,EAAG,EAAK,KAAK,CAAG,EAAI,GACpB,EAAG,EAAK,MAAM,CAAG,CACnB,EACM,EAAkB,AAAA,CAAA,EAAA,EAAA,OAAY,AAAZ,EAAc,EAAK,OAAO,CANjC,AAAC,GAAM,CAAC,OAAO,EAAE,EAAE,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,IAAI,CAAC,KAAK,CAAC;AACxD,kBAAA,EAAE,EAAA,MAAA,CAAU,OAAO,EAAE,IAAI,CAAC,KAAK,CAAG,GAAA,CAAM,CAKU,GAsBxD,EAAO,EACV,SAAS,CAAC,QACV,IAAI,CAAC,GACL,IAAI,CAAC,QACL,IAAI,CAAC,QAAS,SACd,IAAI,CAAC,OAAQ,AAAC,GAAM,EAAM,EAAE,IAAI,CAAC,GAAG,GACpC,IAAI,CAAC,IAAK,GACV,EAAE,CAAC,YAAa,EAAgB,SAAS,EACzC,EAAE,CAAC,aAAc,EAAgB,UAAU,EAC3C,EAAE,CAAC,QA7BU,AAAC,IACf,EAAE,IAAI,CAAC,QAAQ,CAAG,CAAC,EAAE,IAAI,CAAC,QAAQ,CAClC,IAAM,EAAS,EAAK,MAAM,CAAC,CAAC,EAAO,KAC7B,EAAM,QAAQ,EAAE,EAAM,IAAI,CAAC,EAAM,GAAG,EACjC,GACN,EAAE,EACL,GAAI,EAAO,MAAM,CAAG,EAAG,CACrB,IAAM,EAAS,CACb,GAAI,EAAM,EAAE,CACZ,MAAO,EAAM,KAAK,CAClB,MAAO,EAAM,MAAM,CAAC,CAAC,CACrB,UAAW,KACX,OAAA,CACF,EACA,EAAM,WAAW,CAAC,CAAC,EAAO,CAC5B,MACE,EAAM,YAAY,CAAC,EAAM,EAAE,CAE/B,GAaM,EAAU,EAAM,OAAO,CAAC,MAAM,CAAC,AAAC,GAAM,EAAE,EAAE,GAAK,EAAM,EAAE,CACzD,CAAA,EAAQ,MAAM,CAAG,GACnB,CAAO,CAAC,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,AAAC,IACzB,EAAK,OAAO,CAAC,AAAC,IACR,EAAE,GAAG,GAAK,GAAO,CAAA,EAAE,QAAQ,CAAG,CAAA,CAAlC,CACF,EACF,GAEE,EAAQ,MAAM,CAAG,EACnB,EACG,IAAI,CAAC,OAAQ,AAAC,GAAO,EAAE,IAAI,CAAC,QAAQ,CAAG,EAAM,EAAE,IAAI,CAAC,GAAG,EAAI,WAC3D,IAAI,CAAC,eAAgB,AAAC,GAAO,EAAE,IAAI,CAAC,QAAQ,CAAG,EAAI,IACnD,IAAI,CAAC,SAAU,WACf,IAAI,CAAC,eAAgB,AAAC,GAAO,EAAE,IAAI,CAAC,QAAQ,CAAG,EAAI,IAEtD,EAAK,OAAO,CAAC,AAAC,IACZ,EAAE,QAAQ,CAAG,CAAA,CACf,GACA,EACG,IAAI,CAAC,OAAQ,AAAC,GAAM,EAAM,EAAE,IAAI,CAAC,GAAG,GACpC,IAAI,CAAC,eAAgB,GACrB,IAAI,CAAC,SAAU,QAEtB,EAAG,IACL,EAAG,CAAC,EAAM,MAAM,CAAE,EAAM,OAAO,CAAC,EAG9B,AAAA,CAAA,EAAA,EAAA,GAAA,AAAA,EAAC,MADH,CACO,MAAO,CAAE,MAAO,OAAQ,OAAQ,MAAO,EAC1C,SAAA,AAAA,CAAA,EAAA,EAAA,GAAA,AAAA,EAAC,MAAD,CAAK,KAAK,SAAS,GAAI,EAAM,EAAE,CAAE,IAAK,EAAM,MAAO,CAAE,MAAO,OAAQ,OAAQ,MAAO,C,E,EAGzF,CAEA,IAAA,EAAe,CAEf,CAAA,EAAS,SAAS,CAAG,CACnB,KAAM,AAAA,AAAA,EAAA,GAAU,OAAO,CAAC,AAAA,AAAA,EAAA,GAAU,KAAK,CAAC,CAAC,IAAI,UAAU,CACvD,OAAQ,AAAA,AAAA,EAAA,GAAU,KAAK,CAAC,CAAE,EAAG,AAAA,EAAA,GAAU,MAAM,CAAC,UAAU,AAAC,GAAG,UAAU,CACtE,GAAI,AAAA,EAAA,GAAU,MAAM,CAAC,UAAU,CAC/B,MAAO,AAAA,EAAA,GAAU,MAAM,CAAC,UAAU,CAClC,QAAS,AAAA,AAAA,EAAA,GAAU,OAAO,CAAC,AAAA,AAAA,EAAA,GAAU,KAAK,CAAC,CAAC,IAAI,UAAU,CAC1D,YAAa,AAAA,EAAA,GAAU,IAAI,CAAC,UAAU,CACtC,aAAc,AAAA,EAAA,GAAU,IAAI,CAAC,UAAU,CACvC,OAAQ,AAAA,AAAA,EAAA,GAAU,KAAK,CAAC,CACtB,MAAO,AAAA,EAAA,GAAU,MAAM,CAAC,UAAU,CAClC,YAAa,AAAA,EAAA,GAAU,MAAM,CAAC,UAAU,AAC1C,GAAG,UAAU,AACf,C,G,E,Q,S,C,C,C,E,E,E,O,C,U,I,G,I,E,E,SCpIA,EA5BA,SAAuB,CAAK,CAAE,CAAQ,CAAE,CAAM,EAC5C,IAAM,EAAU,EAAA,MAAA,CACN,GACP,MAAM,CAAC,OACP,KAAK,CAAC,UAAW,GACjB,IAAI,CAAC,QAAS,WACd,KAAK,CAAC,UAAW,QACjB,KAAK,CAAC,mBAAoB,SAC1B,KAAK,CAAC,SAAU,SAChB,KAAK,CAAC,eAAgB,OACtB,KAAK,CAAC,gBAAiB,OACvB,KAAK,CAAC,UAAW,OAcpB,MAAO,CAAE,UAZS,SAAc,CAAC,EAC/B,EACG,IAAI,CAAC,EAAS,IACd,KAAK,CAAC,UAAW,IACjB,KAAK,CAAC,OAAQ,CAAA,EAAG,EAAO,CAAC,CAAG,EAAA,KAAA,CAAS,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EACjD,KAAK,CAAC,MAAO,CAAA,EAAG,EAAO,CAAC,CAAG,EAAA,KAAA,CAAS,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CACrD,EAMoB,WAJD,WACjB,EAAQ,KAAK,CAAC,UAAW,OAC3B,CAE+B,CACjC,C","sources":["<anon>","source/components/VisualTools/Chart/PieChart.js","source/components/partials/tooltip.js"],"sourcesContent":["\nfunction $parcel$interopDefault(a) {\n  return a && a.__esModule ? a.default : a;\n}\n\nfunction $parcel$defineInteropFlag(a) {\n  Object.defineProperty(a, '__esModule', {value: true, configurable: true});\n}\n\nfunction $parcel$export(e, n, v, s) {\n  Object.defineProperty(e, n, {get: v, set: s, enumerable: true, configurable: true});\n}\n\n      var $parcel$global = globalThis;\n    var parcelRequire = $parcel$global[\"parcelRequire94c2\"];\nvar parcelRegister = parcelRequire.register;\nparcelRegister(\"528GW\", function(module, exports) {\n\n$parcel$defineInteropFlag(module.exports);\n\n$parcel$export(module.exports, \"default\", () => $3aa3e19e5db4a062$export$2e2bcd8739ae039);\n\nvar $ayMG0 = parcelRequire(\"ayMG0\");\n\nvar $acw62 = parcelRequire(\"acw62\");\n\nvar $9NlP8 = parcelRequire(\"9NlP8\");\n\nvar $c9Z8w = parcelRequire(\"c9Z8w\");\n\nvar $bN8Lq = parcelRequire(\"bN8Lq\");\nfunction $3aa3e19e5db4a062$var$PieChart(props) {\n    const self = (0, $acw62.useRef)();\n    const margin = {\n        top: 5,\n        right: 5,\n        bottom: 5,\n        left: 5\n    };\n    const data = $9NlP8.nest().key((d)=>d[props.fields.x]).rollup((v)=>v.length).entries(props.data);\n    const sum = $9NlP8.sum(data, (d)=>d.value);\n    const pie = $9NlP8.pie().sortValues((a, b)=>b - a).value((d)=>d.value);\n    const arcs = pie(data);\n    (0, $acw62.useEffect)(()=>{\n        setTimeout(()=>{\n            // Remove old svg if any\n            $9NlP8.select(self.current).select('.tooltip').remove('.tooltip');\n            $9NlP8.select(self.current).selectAll('svg').remove('svg');\n            // calculate chart dimensions\n            const rect = self.current.getBoundingClientRect();\n            const innerWidth = rect.width - margin.left - margin.right;\n            const innerHeight = rect.height - margin.top - margin.bottom;\n            const radius = Math.min(innerWidth, innerHeight) / 2;\n            const arc = $9NlP8.arc().innerRadius(0).outerRadius(radius);\n            const color = $9NlP8.scaleOrdinal().domain(data.map((d)=>d.key)).range($9NlP8.quantize((t)=>$9NlP8.interpolateSpectral(t), data.length));\n            const svg = $9NlP8.select(self.current).append('svg').attr('width', rect.width).attr('height', rect.height);\n            const viewer = svg.append('g').attr('transform', `translate(${innerWidth / 2 + margin.left},${innerHeight / 2 + margin.top})`);\n            if (innerWidth > 500) {\n                const legendG = svg.selectAll('.legend').data(arcs).enter().append('g').attr('transform', (d, i)=>`translate(${innerWidth - 110},${i * 15 + 20})`).attr('class', 'legend');\n                legendG.append('rect') // make a matching color rect\n                .attr('width', 13).attr('height', 13).attr('fill', (d, i)=>color(i)).attr('stroke', 'grey').style('stroke-width', '1px');\n                legendG.append('text') // add the text\n                .text((d)=>`${d.value}  ${d.data.key}`).style('font-size', 15).attr('y', 13).attr('x', 15);\n            }\n            // create a tooltip\n            const addLabel = (d)=>`Class: ${d.data.key} Count: ${d.data.value} \n      Percentage: ${$9NlP8.format('.0%')(d.data.value / sum)}`;\n            const offset = {\n                x: rect.width / 2 + 20,\n                y: rect.height / 2\n            };\n            const tooltipHandlers = (0, $bN8Lq.default)(self.current, addLabel, offset);\n            const onClick = (d)=>{\n                d.data.selected = !d.data.selected;\n                const values = data.reduce((value, point)=>{\n                    if (point.selected) value.push(point.key);\n                    return value;\n                }, []);\n                if (values.length > 0) {\n                    const filter = {\n                        id: props.id,\n                        title: props.title,\n                        field: props.fields.x,\n                        operation: 'in',\n                        values: values\n                    };\n                    props.filterAdded([\n                        filter\n                    ]);\n                } else props.filterRemove(props.id);\n            };\n            const pies = viewer.selectAll('path').data(arcs).join('path').attr('class', 'slide').attr('fill', (d)=>color(d.data.key)).attr('d', arc).on('mousemove', tooltipHandlers.mousemove).on('mouseleave', tooltipHandlers.mouseleave).on('click', onClick);\n            const filters = props.filters.filter((f)=>f.id === props.id);\n            if (filters.length > 0) filters[0].values.forEach((value)=>{\n                data.forEach((d)=>{\n                    if (d.key === value) d.selected = true;\n                });\n            });\n            if (filters.length > 0) pies.attr('fill', (d)=>d.data.selected ? color(d.data.key) : '#C0C0C0').attr('fill-opacity', (d)=>d.data.selected ? 1 : 0.5).attr('stroke', '#CCCCCC').attr('stroke-width', (d)=>d.data.selected ? 3 : 0);\n            else {\n                data.forEach((d)=>{\n                    d.selected = false;\n                });\n                pies.attr('fill', (d)=>color(d.data.key)).attr('fill-opacity', 1).attr('stroke', 'none');\n            }\n        }, 100);\n    }, [\n        props.layout,\n        props.filters\n    ]);\n    return /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n        style: {\n            width: '100%',\n            height: '100%'\n        },\n        children: /*#__PURE__*/ (0, $ayMG0.jsx)(\"div\", {\n            role: \"figure\",\n            id: props.id,\n            ref: self,\n            style: {\n                width: '100%',\n                height: '100%'\n            }\n        })\n    });\n}\nvar $3aa3e19e5db4a062$export$2e2bcd8739ae039 = $3aa3e19e5db4a062$var$PieChart;\n$3aa3e19e5db4a062$var$PieChart.propTypes = {\n    data: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).arrayOf((0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).shape({})).isRequired,\n    fields: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).shape({\n        x: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).string.isRequired\n    }).isRequired,\n    id: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).string.isRequired,\n    title: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).string.isRequired,\n    filters: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).arrayOf((0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).shape({})).isRequired,\n    filterAdded: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).func.isRequired,\n    filterRemove: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).func.isRequired,\n    layout: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).shape({\n        width: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).number.isRequired,\n        currentCols: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).number.isRequired\n    }).isRequired\n};\n\n});\nparcelRegister(\"bN8Lq\", function(module, exports) {\n\n$parcel$export(module.exports, \"default\", () => $895b11a613892f4e$export$2e2bcd8739ae039);\n\nvar $9NlP8 = parcelRequire(\"9NlP8\");\n/**\n * @function createTooltip\n * @description creates a tooltip dev and mount it to\n * the chart\n * @param {*} mount reference to the chart to mount tooltip on\n * @param {Function} addLabel function to generate text inside tooltip\n * @param {Object} offset the x and y offset from mouse position to position tooltip\n * @returns {Object} contains to function mousemove and mouseleave handlers\n */ function $895b11a613892f4e$var$createTooltip(mount, addLabel, offset) {\n    const tooltip = $9NlP8.select(mount).append('div').style('opacity', 1).attr('class', 'tooltip').style('display', 'none').style('background-color', 'white').style('border', 'solid').style('border-width', '2px').style('border-radius', '5px').style('padding', '5px');\n    const mousemove = function move(d) {\n        tooltip.html(addLabel(d)).style('display', '').style('left', `${offset.x + $9NlP8.mouse(this)[0]}px`).style('top', `${offset.y + $9NlP8.mouse(this)[1]}px`);\n    };\n    const mouseleave = function leave() {\n        tooltip.style('display', 'none');\n    };\n    return {\n        mousemove: mousemove,\n        mouseleave: mouseleave\n    };\n}\nvar $895b11a613892f4e$export$2e2bcd8739ae039 = $895b11a613892f4e$var$createTooltip;\n\n});\n\n\n\n//# sourceMappingURL=PieChart.1a9d2563.js.map\n","import React, { useRef, useEffect } from 'react';\nimport * as d3 from 'd3';\nimport PropTypes from 'prop-types';\nimport createTooltip from '../../partials/tooltip';\n\nfunction PieChart(props) {\n  const self = useRef();\n  const margin = {\n    top: 5,\n    right: 5,\n    bottom: 5,\n    left: 5,\n  };\n  const data = d3\n    .nest()\n    .key((d) => d[props.fields.x])\n\n    .rollup((v) => v.length)\n    .entries(props.data);\n\n  const sum = d3.sum(data, (d) => d.value);\n  const pie = d3\n    .pie()\n    .sortValues((a, b) => b - a)\n    .value((d) => d.value);\n\n  const arcs = pie(data);\n\n  useEffect(() => {\n    setTimeout(() => {\n      // Remove old svg if any\n      d3.select(self.current).select('.tooltip').remove('.tooltip');\n      d3.select(self.current).selectAll('svg').remove('svg');\n\n      // calculate chart dimensions\n      const rect = self.current.getBoundingClientRect();\n      const innerWidth = rect.width - margin.left - margin.right;\n      const innerHeight = rect.height - margin.top - margin.bottom;\n      const radius = Math.min(innerWidth, innerHeight) / 2;\n\n      const arc = d3.arc().innerRadius(0).outerRadius(radius);\n\n      const color = d3\n        .scaleOrdinal()\n        .domain(data.map((d) => d.key))\n        .range(d3.quantize((t) => d3.interpolateSpectral(t), data.length));\n\n      const svg = d3\n        .select(self.current)\n        .append('svg')\n        .attr('width', rect.width)\n        .attr('height', rect.height);\n\n      const viewer = svg\n        .append('g')\n        .attr(\n          'transform',\n          `translate(${innerWidth / 2 + margin.left},${innerHeight / 2 + margin.top})`,\n        );\n\n      if (innerWidth > 500) {\n        const legendG = svg\n          .selectAll('.legend')\n          .data(arcs)\n          .enter()\n          .append('g')\n          .attr('transform', (d, i) => `translate(${innerWidth - 110},${i * 15 + 20})`)\n          .attr('class', 'legend');\n\n        legendG\n          .append('rect') // make a matching color rect\n          .attr('width', 13)\n          .attr('height', 13)\n          .attr('fill', (d, i) => color(i))\n          .attr('stroke', 'grey')\n          .style('stroke-width', '1px');\n\n        legendG\n          .append('text') // add the text\n          .text((d) => `${d.value}  ${d.data.key}`)\n          .style('font-size', 15)\n          .attr('y', 13)\n          .attr('x', 15);\n      }\n\n      // create a tooltip\n      const addLabel = (d) => `Class: ${d.data.key} Count: ${d.data.value} \n      Percentage: ${d3.format('.0%')(d.data.value / sum)}`;\n      const offset = {\n        x: rect.width / 2 + 20,\n        y: rect.height / 2,\n      };\n      const tooltipHandlers = createTooltip(self.current, addLabel, offset);\n\n      const onClick = (d) => {\n        d.data.selected = !d.data.selected;\n        const values = data.reduce((value, point) => {\n          if (point.selected) value.push(point.key);\n          return value;\n        }, []);\n        if (values.length > 0) {\n          const filter = {\n            id: props.id,\n            title: props.title,\n            field: props.fields.x,\n            operation: 'in',\n            values,\n          };\n          props.filterAdded([filter]);\n        } else {\n          props.filterRemove(props.id);\n        }\n      };\n\n      const pies = viewer\n        .selectAll('path')\n        .data(arcs)\n        .join('path')\n        .attr('class', 'slide')\n        .attr('fill', (d) => color(d.data.key))\n        .attr('d', arc)\n        .on('mousemove', tooltipHandlers.mousemove)\n        .on('mouseleave', tooltipHandlers.mouseleave)\n        .on('click', onClick);\n\n      const filters = props.filters.filter((f) => f.id === props.id);\n      if (filters.length > 0) {\n        filters[0].values.forEach((value) => {\n          data.forEach((d) => {\n            if (d.key === value) d.selected = true;\n          });\n        });\n      }\n      if (filters.length > 0) {\n        pies\n          .attr('fill', (d) => (d.data.selected ? color(d.data.key) : '#C0C0C0'))\n          .attr('fill-opacity', (d) => (d.data.selected ? 1 : 0.5))\n          .attr('stroke', '#CCCCCC')\n          .attr('stroke-width', (d) => (d.data.selected ? 3 : 0));\n      } else {\n        data.forEach((d) => {\n          d.selected = false;\n        });\n        pies\n          .attr('fill', (d) => color(d.data.key))\n          .attr('fill-opacity', 1)\n          .attr('stroke', 'none');\n      }\n    }, 100);\n  }, [props.layout, props.filters]);\n\n  return (\n    <div style={{ width: '100%', height: '100%' }}>\n      <div role=\"figure\" id={props.id} ref={self} style={{ width: '100%', height: '100%' }} />\n    </div>\n  );\n}\n\nexport default PieChart;\n\nPieChart.propTypes = {\n  data: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  fields: PropTypes.shape({ x: PropTypes.string.isRequired }).isRequired,\n  id: PropTypes.string.isRequired,\n  title: PropTypes.string.isRequired,\n  filters: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  filterAdded: PropTypes.func.isRequired,\n  filterRemove: PropTypes.func.isRequired,\n  layout: PropTypes.shape({\n    width: PropTypes.number.isRequired,\n    currentCols: PropTypes.number.isRequired,\n  }).isRequired,\n};\n","import * as d3 from 'd3';\n\n/**\n * @function createTooltip\n * @description creates a tooltip dev and mount it to\n * the chart\n * @param {*} mount reference to the chart to mount tooltip on\n * @param {Function} addLabel function to generate text inside tooltip\n * @param {Object} offset the x and y offset from mouse position to position tooltip\n * @returns {Object} contains to function mousemove and mouseleave handlers\n */\n\nfunction createTooltip(mount, addLabel, offset) {\n  const tooltip = d3\n    .select(mount)\n    .append('div')\n    .style('opacity', 1)\n    .attr('class', 'tooltip')\n    .style('display', 'none')\n    .style('background-color', 'white')\n    .style('border', 'solid')\n    .style('border-width', '2px')\n    .style('border-radius', '5px')\n    .style('padding', '5px');\n\n  const mousemove = function move(d) {\n    tooltip\n      .html(addLabel(d))\n      .style('display', '')\n      .style('left', `${offset.x + d3.mouse(this)[0]}px`)\n      .style('top', `${offset.y + d3.mouse(this)[1]}px`);\n  };\n\n  const mouseleave = function leave() {\n    tooltip.style('display', 'none');\n  };\n\n  return { mousemove, mouseleave };\n}\n\nexport default createTooltip;\n"],"names":["$parcel$interopDefault","a","__esModule","default","$parcel$export","e","n","v","s","Object","defineProperty","get","set","enumerable","configurable","parcelRequire","$parcel$global","globalThis","parcelRegister","register","module","exports","value","$3aa3e19e5db4a062$export$2e2bcd8739ae039","$ayMG0","$acw62","$9NlP8","$c9Z8w","$bN8Lq","$3aa3e19e5db4a062$var$PieChart","props","self","useRef","data","nest","key","d","fields","x","rollup","length","entries","sum","arcs","pie","sortValues","b","useEffect","setTimeout","select","current","remove","selectAll","rect","getBoundingClientRect","innerWidth","width","innerHeight","height","radius","Math","min","arc","innerRadius","outerRadius","color","scaleOrdinal","domain","map","range","quantize","t","interpolateSpectral","svg","append","attr","viewer","legendG","enter","i","style","text","offset","y","tooltipHandlers","format","pies","join","on","mousemove","mouseleave","selected","values","reduce","point","push","filter","id","title","field","operation","filterAdded","filterRemove","filters","f","forEach","layout","jsx","children","role","ref","propTypes","arrayOf","shape","isRequired","string","func","number","currentCols","$895b11a613892f4e$export$2e2bcd8739ae039","mount","addLabel","tooltip","html","mouse"],"version":3,"file":"PieChart.1a9d2563.js.map"}