function t(t){return t&&t.__esModule?t.default:t}var e=globalThis.parcelRequire94c2;(0,e.register)("eoPnA",function(i,s){Object.defineProperty(i.exports,"__esModule",{value:!0,configurable:!0}),Object.defineProperty(i.exports,"default",{get:()=>h,set:void 0,enumerable:!0,configurable:!0});var r=e("acw62"),a=e("9NlP8"),n=e("c9Z8w"),o=e("63tWu");class h extends r.PureComponent{constructor(e){super(e),this.self=t(r).createRef(),this.state={margin:{top:5,right:10,bottom:25,left:25}},this.state.data=this.props.data.filter(t=>"N/A"!==t[this.props.fields.x]&&"N/A"!==t[this.props.fields.y]&&"N/A"!==t[this.props.fields.z])}componentDidMount(){this.componentDidUpdate()}componentDidUpdate(){setTimeout(()=>{a.select(this.self.current).selectAll("canvas").remove("canvas"),a.select(this.self.current).selectAll("svg").remove("svg"),this.rect=this.self.current.getBoundingClientRect();let t=this.rect.width-this.state.margin.left-this.state.margin.right,e=this.rect.height-this.state.margin.top-this.state.margin.bottom;this.canvas=a.select(this.self.current).append("canvas").attr("width",t).attr("height",e).style("transform",`translate(${this.state.margin.left}px,${this.state.margin.top}px)`);let i=a.select(this.self.current).append("svg").attr("width",this.rect.width).attr("height",this.rect.height).attr("transform",`translate(0,${-e})`),s=i.append("g").attr("transform",`translate(${this.state.margin.left},0)`);this.xScale=this.createScaleLiner(this.props.fields.x,[0,t]),this.yScale=this.createScaleLiner(this.props.fields.y,[e,0]),this.radiusScale=this.createScaleLiner(this.props.fields.z,[3,10]);let r=()=>(console.log(i),[a.event.sourceEvent.clientX-i.node().getBoundingClientRect().x-this.state.margin.left,a.event.sourceEvent.clientY-i.node().getBoundingClientRect().y]);s.append("g").attr("transform",`translate(0,${e})`).call(a.axisBottom(this.xScale).tickSize(-e)),s.append("g").call(a.axisLeft(this.yScale).tickSize(-t)),this.brush=a.brush().extent([[0,0],[t,e]]).on("start",()=>{this.startPosition=r()}).on("brush",()=>{this.endPosition=r(),i.selectAll("rect").remove("rect");let t=Math.min(this.startPosition[0],this.endPosition[0]),e=Math.min(this.startPosition[1],this.endPosition[1]);i.append("rect").attr("position","absolute").attr("x",t+this.state.margin.left).attr("y",e).attr("width",Math.abs(this.endPosition[0]-this.startPosition[0])).attr("height",Math.abs(this.endPosition[1]-this.startPosition[1])).attr("fill","rgba(211, 211, 211, 0.5)")}).on("end",()=>{this.endPosition=r(),i.selectAll("rect").remove("rect");let t=Math.min(this.startPosition[0],this.endPosition[0]),e=Math.min(this.startPosition[1],this.endPosition[1]);i.append("rect").attr("position","absolute").attr("x",t+this.state.margin.left).attr("y",e).attr("width",Math.abs(this.endPosition[0]-this.startPosition[0])).attr("height",Math.abs(this.endPosition[1]-this.startPosition[1])).attr("fill","rgba(211, 211, 211, 0.5)"),this.end()}),s.append("g").call(this.brush),this.draw()},100)}drawPoint(t){let e=this.xScale(t[this.props.fields.x]),i=this.yScale(t[this.props.fields.y]),s=this.props.fields.z?this.radiusScale(t[this.props.fields.z]):3;this.context.beginPath(),this.context.arc(e,i,s,0,2*Math.PI),this.context.closePath(),this.context.fill(),this.context.stroke()}draw(){this.context=this.canvas.node().getContext("2d"),this.context.clearRect(0,0,this.rect.width,this.rect.height),this.context.fillStyle="#87CEEB",this.context.strokeWidth=1,this.context.strokeStyle="#4682B4",this.context.globalAlpha=1,0===this.props.filters.length?this.state.data.forEach(t=>{this.drawPoint(t)}):this.state.data.forEach(t=>{this.props.filterData.includes(t)?(this.context.fillStyle="#87CEEB",this.context.strokeWidth=1,this.context.strokeStyle="#4682B4",this.context.globalAlpha=1):(this.context.fillStyle="#c0c0c0c0",this.context.strokeWidth=1,this.context.strokeStyle="#000000",this.context.globalAlpha=.2),this.drawPoint(t)})}createScaleLiner(t,e){let i=a.extent(this.state.data,e=>e[t]),s=(i[1]-i[0])*.1;return a.scaleLinear().domain([i[0]-s,i[1]+s]).range(e).nice()}end(){if(!a.event.selection)return;let[t,e]=[Math.min(this.startPosition[0],this.endPosition[0]),Math.min(this.startPosition[1],this.endPosition[1])],[i,s]=[Math.max(this.startPosition[0],this.endPosition[0]),Math.max(this.startPosition[1],this.endPosition[1])],r=[{id:`${this.props.id}_x`,title:this.props.title,field:this.props.fields.x,operation:"range",values:[(0,o.numFixed)(this.xScale.invert(t)),(0,o.numFixed)(this.xScale.invert(i))]},{id:`${this.props.id}_y`,title:this.props.title,field:this.props.fields.y,operation:"range",values:[(0,o.numFixed)(this.yScale.invert(s)),(0,o.numFixed)(this.yScale.invert(e))]}];this.props.filterAdded(r)}render(){return t(r).createElement("div",{id:this.props.id,ref:this.self,role:"figure",style:{width:"100%",height:"100%"}})}}h.propTypes={data:t(n).arrayOf(t(n).shape({})).isRequired,filterData:t(n).arrayOf(t(n).shape({})).isRequired,fields:t(n).shape({x:t(n).string.isRequired,y:t(n).string.isRequired,z:t(n).string}).isRequired,id:t(n).string.isRequired,title:t(n).string.isRequired,filters:t(n).arrayOf(t(n).shape({})).isRequired,filterAdded:t(n).func.isRequired}});
//# sourceMappingURL=ScatterChart.98cc4962.js.map
