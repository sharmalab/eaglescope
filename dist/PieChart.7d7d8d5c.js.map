{"mappings":"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","sources":["<anon>","source/components/VisualTools/Chart/PieChart.js","source/components/partials/tooltip.js"],"sourcesContent":["\nfunction $parcel$interopDefault(a) {\n  return a && a.__esModule ? a.default : a;\n}\n\nfunction $parcel$defineInteropFlag(a) {\n  Object.defineProperty(a, '__esModule', {value: true, configurable: true});\n}\n\nfunction $parcel$export(e, n, v, s) {\n  Object.defineProperty(e, n, {get: v, set: s, enumerable: true, configurable: true});\n}\n\n      var $parcel$global = globalThis;\n    var parcelRequire = $parcel$global[\"parcelRequire94c2\"];\nvar parcelRegister = parcelRequire.register;\nparcelRegister(\"528GW\", function(module, exports) {\n\n$parcel$defineInteropFlag(module.exports);\n\n$parcel$export(module.exports, \"default\", () => $3aa3e19e5db4a062$export$2e2bcd8739ae039);\n\nvar $acw62 = parcelRequire(\"acw62\");\n\nvar $9NlP8 = parcelRequire(\"9NlP8\");\n\nvar $c9Z8w = parcelRequire(\"c9Z8w\");\n\nvar $bN8Lq = parcelRequire(\"bN8Lq\");\nfunction $3aa3e19e5db4a062$var$PieChart(props) {\n    const self = (0, $acw62.useRef)();\n    const margin = {\n        top: 5,\n        right: 5,\n        bottom: 5,\n        left: 5\n    };\n    const data = $9NlP8.nest().key((d)=>d[props.fields.x]).rollup((v)=>v.length).entries(props.data);\n    const sum = $9NlP8.sum(data, (d)=>d.value);\n    const pie = $9NlP8.pie().sortValues((a, b)=>b - a).value((d)=>d.value);\n    const arcs = pie(data);\n    (0, $acw62.useEffect)(()=>{\n        setTimeout(()=>{\n            // Remove old svg if any\n            $9NlP8.select(self.current).select('.tooltip').remove('.tooltip');\n            $9NlP8.select(self.current).selectAll('svg').remove('svg');\n            // calculate chart dimensions\n            const rect = self.current.getBoundingClientRect();\n            const innerWidth = rect.width - margin.left - margin.right;\n            const innerHeight = rect.height - margin.top - margin.bottom;\n            const radius = Math.min(innerWidth, innerHeight) / 2;\n            const arc = $9NlP8.arc().innerRadius(0).outerRadius(radius);\n            const color = $9NlP8.scaleOrdinal().domain(data.map((d)=>d.key)).range($9NlP8.quantize((t)=>$9NlP8.interpolateSpectral(t), data.length));\n            const svg = $9NlP8.select(self.current).append('svg').attr('width', rect.width).attr('height', rect.height);\n            const viewer = svg.append('g').attr('transform', `translate(${innerWidth / 2 + margin.left},${innerHeight / 2 + margin.top})`);\n            if (innerWidth > 500) {\n                const legendG = svg.selectAll('.legend').data(arcs).enter().append('g').attr('transform', (d, i)=>`translate(${innerWidth - 110},${i * 15 + 20})`).attr('class', 'legend');\n                legendG.append('rect') // make a matching color rect\n                .attr('width', 13).attr('height', 13).attr('fill', (d, i)=>color(i)).attr('stroke', 'grey').style('stroke-width', '1px');\n                legendG.append('text') // add the text\n                .text((d)=>`${d.value}  ${d.data.key}`).style('font-size', 15).attr('y', 13).attr('x', 15);\n            }\n            // create a tooltip\n            const addLabel = (d)=>`Class: ${d.data.key} Count: ${d.data.value} \n      Percentage: ${$9NlP8.format('.0%')(d.data.value / sum)}`;\n            const offset = {\n                x: rect.width / 2 + 20,\n                y: rect.height / 2\n            };\n            const tooltipHandlers = (0, $bN8Lq.default)(self.current, addLabel, offset);\n            const onClick = (d)=>{\n                d.data.selected = !d.data.selected;\n                const values = data.reduce((value, point)=>{\n                    if (point.selected) value.push(point.key);\n                    return value;\n                }, []);\n                if (values.length > 0) {\n                    const filter = {\n                        id: props.id,\n                        title: props.title,\n                        field: props.fields.x,\n                        operation: 'in',\n                        values: values\n                    };\n                    props.filterAdded([\n                        filter\n                    ]);\n                } else props.filterRemove(props.id);\n            };\n            const pies = viewer.selectAll('path').data(arcs).join('path').attr('class', 'slide').attr('fill', (d)=>color(d.data.key)).attr('d', arc).on('mousemove', tooltipHandlers.mousemove).on('mouseleave', tooltipHandlers.mouseleave).on('click', onClick);\n            const filters = props.filters.filter((f)=>f.id === props.id);\n            if (filters.length > 0) filters[0].values.forEach((value)=>{\n                data.forEach((d)=>{\n                    if (d.key === value) d.selected = true;\n                });\n            });\n            if (filters.length > 0) pies.attr('fill', (d)=>d.data.selected ? color(d.data.key) : '#C0C0C0').attr('fill-opacity', (d)=>d.data.selected ? 1 : 0.5).attr('stroke', '#CCCCCC').attr('stroke-width', (d)=>d.data.selected ? 3 : 0);\n            else {\n                data.forEach((d)=>{\n                    d.selected = false;\n                });\n                pies.attr('fill', (d)=>color(d.data.key)).attr('fill-opacity', 1).attr('stroke', 'none');\n            }\n        }, 100);\n    }, [\n        props.layout,\n        props.filters\n    ]);\n    return /*#__PURE__*/ (0, (/*@__PURE__*/$parcel$interopDefault($acw62))).createElement(\"div\", {\n        style: {\n            width: '100%',\n            height: '100%'\n        }\n    }, /*#__PURE__*/ (0, (/*@__PURE__*/$parcel$interopDefault($acw62))).createElement(\"div\", {\n        role: \"figure\",\n        id: props.id,\n        ref: self,\n        style: {\n            width: '100%',\n            height: '100%'\n        }\n    }));\n}\nvar $3aa3e19e5db4a062$export$2e2bcd8739ae039 = $3aa3e19e5db4a062$var$PieChart;\n$3aa3e19e5db4a062$var$PieChart.propTypes = {\n    data: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).arrayOf((0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).shape({})).isRequired,\n    fields: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).shape({\n        x: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).string.isRequired\n    }).isRequired,\n    id: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).string.isRequired,\n    title: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).string.isRequired,\n    filters: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).arrayOf((0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).shape({})).isRequired,\n    filterAdded: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).func.isRequired,\n    filterRemove: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).func.isRequired,\n    layout: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).shape({\n        width: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).number.isRequired,\n        currentCols: (0, (/*@__PURE__*/$parcel$interopDefault($c9Z8w))).number.isRequired\n    }).isRequired\n};\n\n});\nparcelRegister(\"bN8Lq\", function(module, exports) {\n\n$parcel$export(module.exports, \"default\", () => $895b11a613892f4e$export$2e2bcd8739ae039);\n\nvar $9NlP8 = parcelRequire(\"9NlP8\");\n/**\n * @function createTooltip\n * @description creates a tooltip dev and mount it to\n * the chart\n * @param {*} mount reference to the chart to mount tooltip on\n * @param {Function} addLabel function to generate text inside tooltip\n * @param {Object} offset the x and y offset from mouse position to position tooltip\n * @returns {Object} contains to function mousemove and mouseleave handlers\n */ function $895b11a613892f4e$var$createTooltip(mount, addLabel, offset) {\n    const tooltip = $9NlP8.select(mount).append('div').style('opacity', 1).attr('class', 'tooltip').style('display', 'none').style('background-color', 'white').style('border', 'solid').style('border-width', '2px').style('border-radius', '5px').style('padding', '5px');\n    const mousemove = function move(d) {\n        tooltip.html(addLabel(d)).style('display', '').style('left', `${offset.x + $9NlP8.mouse(this)[0]}px`).style('top', `${offset.y + $9NlP8.mouse(this)[1]}px`);\n    };\n    const mouseleave = function leave() {\n        tooltip.style('display', 'none');\n    };\n    return {\n        mousemove: mousemove,\n        mouseleave: mouseleave\n    };\n}\nvar $895b11a613892f4e$export$2e2bcd8739ae039 = $895b11a613892f4e$var$createTooltip;\n\n});\n\n\n\n//# sourceMappingURL=PieChart.7d7d8d5c.js.map\n","import React, { useRef, useEffect } from 'react';\nimport * as d3 from 'd3';\nimport PropTypes from 'prop-types';\nimport createTooltip from '../../partials/tooltip';\n\nfunction PieChart(props) {\n  const self = useRef();\n  const margin = {\n    top: 5,\n    right: 5,\n    bottom: 5,\n    left: 5,\n  };\n  const data = d3\n    .nest()\n    .key((d) => d[props.fields.x])\n\n    .rollup((v) => v.length)\n    .entries(props.data);\n\n  const sum = d3.sum(data, (d) => d.value);\n  const pie = d3\n    .pie()\n    .sortValues((a, b) => b - a)\n    .value((d) => d.value);\n\n  const arcs = pie(data);\n\n  useEffect(() => {\n    setTimeout(() => {\n      // Remove old svg if any\n      d3.select(self.current).select('.tooltip').remove('.tooltip');\n      d3.select(self.current).selectAll('svg').remove('svg');\n\n      // calculate chart dimensions\n      const rect = self.current.getBoundingClientRect();\n      const innerWidth = rect.width - margin.left - margin.right;\n      const innerHeight = rect.height - margin.top - margin.bottom;\n      const radius = Math.min(innerWidth, innerHeight) / 2;\n\n      const arc = d3.arc().innerRadius(0).outerRadius(radius);\n\n      const color = d3\n        .scaleOrdinal()\n        .domain(data.map((d) => d.key))\n        .range(d3.quantize((t) => d3.interpolateSpectral(t), data.length));\n\n      const svg = d3\n        .select(self.current)\n        .append('svg')\n        .attr('width', rect.width)\n        .attr('height', rect.height);\n\n      const viewer = svg\n        .append('g')\n        .attr(\n          'transform',\n          `translate(${innerWidth / 2 + margin.left},${innerHeight / 2 + margin.top})`,\n        );\n\n      if (innerWidth > 500) {\n        const legendG = svg\n          .selectAll('.legend')\n          .data(arcs)\n          .enter()\n          .append('g')\n          .attr('transform', (d, i) => `translate(${innerWidth - 110},${i * 15 + 20})`)\n          .attr('class', 'legend');\n\n        legendG\n          .append('rect') // make a matching color rect\n          .attr('width', 13)\n          .attr('height', 13)\n          .attr('fill', (d, i) => color(i))\n          .attr('stroke', 'grey')\n          .style('stroke-width', '1px');\n\n        legendG\n          .append('text') // add the text\n          .text((d) => `${d.value}  ${d.data.key}`)\n          .style('font-size', 15)\n          .attr('y', 13)\n          .attr('x', 15);\n      }\n\n      // create a tooltip\n      const addLabel = (d) => `Class: ${d.data.key} Count: ${d.data.value} \n      Percentage: ${d3.format('.0%')(d.data.value / sum)}`;\n      const offset = {\n        x: rect.width / 2 + 20,\n        y: rect.height / 2,\n      };\n      const tooltipHandlers = createTooltip(self.current, addLabel, offset);\n\n      const onClick = (d) => {\n        d.data.selected = !d.data.selected;\n        const values = data.reduce((value, point) => {\n          if (point.selected) value.push(point.key);\n          return value;\n        }, []);\n        if (values.length > 0) {\n          const filter = {\n            id: props.id,\n            title: props.title,\n            field: props.fields.x,\n            operation: 'in',\n            values,\n          };\n          props.filterAdded([filter]);\n        } else {\n          props.filterRemove(props.id);\n        }\n      };\n\n      const pies = viewer\n        .selectAll('path')\n        .data(arcs)\n        .join('path')\n        .attr('class', 'slide')\n        .attr('fill', (d) => color(d.data.key))\n        .attr('d', arc)\n        .on('mousemove', tooltipHandlers.mousemove)\n        .on('mouseleave', tooltipHandlers.mouseleave)\n        .on('click', onClick);\n\n      const filters = props.filters.filter((f) => f.id === props.id);\n      if (filters.length > 0) {\n        filters[0].values.forEach((value) => {\n          data.forEach((d) => {\n            if (d.key === value) d.selected = true;\n          });\n        });\n      }\n      if (filters.length > 0) {\n        pies\n          .attr('fill', (d) => (d.data.selected ? color(d.data.key) : '#C0C0C0'))\n          .attr('fill-opacity', (d) => (d.data.selected ? 1 : 0.5))\n          .attr('stroke', '#CCCCCC')\n          .attr('stroke-width', (d) => (d.data.selected ? 3 : 0));\n      } else {\n        data.forEach((d) => {\n          d.selected = false;\n        });\n        pies\n          .attr('fill', (d) => color(d.data.key))\n          .attr('fill-opacity', 1)\n          .attr('stroke', 'none');\n      }\n    }, 100);\n  }, [props.layout, props.filters]);\n\n  return (\n    <div style={{ width: '100%', height: '100%' }}>\n      <div role=\"figure\" id={props.id} ref={self} style={{ width: '100%', height: '100%' }} />\n    </div>\n  );\n}\n\nexport default PieChart;\n\nPieChart.propTypes = {\n  data: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  fields: PropTypes.shape({ x: PropTypes.string.isRequired }).isRequired,\n  id: PropTypes.string.isRequired,\n  title: PropTypes.string.isRequired,\n  filters: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  filterAdded: PropTypes.func.isRequired,\n  filterRemove: PropTypes.func.isRequired,\n  layout: PropTypes.shape({\n    width: PropTypes.number.isRequired,\n    currentCols: PropTypes.number.isRequired,\n  }).isRequired,\n};\n","import * as d3 from 'd3';\n\n/**\n * @function createTooltip\n * @description creates a tooltip dev and mount it to\n * the chart\n * @param {*} mount reference to the chart to mount tooltip on\n * @param {Function} addLabel function to generate text inside tooltip\n * @param {Object} offset the x and y offset from mouse position to position tooltip\n * @returns {Object} contains to function mousemove and mouseleave handlers\n */\n\nfunction createTooltip(mount, addLabel, offset) {\n  const tooltip = d3\n    .select(mount)\n    .append('div')\n    .style('opacity', 1)\n    .attr('class', 'tooltip')\n    .style('display', 'none')\n    .style('background-color', 'white')\n    .style('border', 'solid')\n    .style('border-width', '2px')\n    .style('border-radius', '5px')\n    .style('padding', '5px');\n\n  const mousemove = function move(d) {\n    tooltip\n      .html(addLabel(d))\n      .style('display', '')\n      .style('left', `${offset.x + d3.mouse(this)[0]}px`)\n      .style('top', `${offset.y + d3.mouse(this)[1]}px`);\n  };\n\n  const mouseleave = function leave() {\n    tooltip.style('display', 'none');\n  };\n\n  return { mousemove, mouseleave };\n}\n\nexport default createTooltip;\n"],"names":["$parcel$interopDefault","a","__esModule","default","$parcel$export","e","n","v","s","Object","defineProperty","get","set","enumerable","configurable","parcelRequire","$parcel$global","globalThis","parcelRegister","register","module","exports","value","$3aa3e19e5db4a062$export$2e2bcd8739ae039","$acw62","$9NlP8","$c9Z8w","$bN8Lq","$3aa3e19e5db4a062$var$PieChart","props","self","useRef","data","nest","key","d","fields","x","rollup","length","entries","sum","arcs","pie","sortValues","b","useEffect","setTimeout","select","current","remove","selectAll","rect","getBoundingClientRect","innerWidth","width","innerHeight","height","radius","Math","min","arc","innerRadius","outerRadius","color","scaleOrdinal","domain","map","range","quantize","t","interpolateSpectral","svg","append","attr","viewer","legendG","enter","i","style","text","offset","y","tooltipHandlers","format","pies","join","on","mousemove","mouseleave","selected","values","reduce","point","push","filter","id","title","field","operation","filterAdded","filterRemove","filters","f","forEach","layout","createElement","role","ref","propTypes","arrayOf","shape","isRequired","string","func","number","currentCols","$895b11a613892f4e$export$2e2bcd8739ae039","mount","addLabel","tooltip","html","mouse","React","d3","PropTypes","createTooltip","PieChart","margin","top","right","bottom","left","onClick","move","leave"],"version":3,"file":"PieChart.7d7d8d5c.js.map"}