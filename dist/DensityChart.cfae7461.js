function e(e){return e&&e.__esModule?e.default:e}var t=globalThis.parcelRequire94c2;(0,t.register)("lSqO9",function(r,a){Object.defineProperty(r.exports,"__esModule",{value:!0,configurable:!0}),Object.defineProperty(r.exports,"default",{get:()=>d,set:void 0,enumerable:!0,configurable:!0});var i=t("acw62"),n=t("9NlP8"),l=t("c9Z8w"),s=t("63tWu");function u(t){let r=[0,0],a=[0,0],l=(0,i.useRef)(),u=(0,i.useRef)(),d=(0,i.useRef)({x:n.scaleLinear(),y:n.scaleLinear()}),c=()=>{if(!n.event.selection)return;let[e,i]=[Math.min(r[0],a[0]),Math.min(r[1],a[1])],[l,u]=[Math.max(r[0],a[0]),Math.max(r[1],a[1])],c=[{id:`${t.id}_x`,title:t.title,field:t.fields.x,operation:"range",values:[(0,s.numFixed)(d.current.x.invert(e)),(0,s.numFixed)(d.current.x.invert(l))]},{id:`${t.id}_y`,title:t.title,field:t.fields.y,operation:"range",values:[(0,s.numFixed)(d.current.y.invert(u)),(0,s.numFixed)(d.current.y.invert(i))]}];t.filterAdded(c)};return(0,i.useEffect)(()=>{setTimeout(()=>{n.select(l.current).selectAll("svg").remove("svg");let e=l.current.getBoundingClientRect(),i=e.width-40-30,s=e.height-10-20;u.current=n.select(l.current).append("svg").attr("width",e.width).attr("height",e.height).append("g").attr("transform","translate(40,10)");let o=n.extent(t.data,e=>e[t.fields.x]),h=(o[1]-o[0])*.1,f=n.extent(t.data,e=>e[t.fields.y]),g=(f[1]-f[0])*.1;d.current.x.domain([o[0]-h,o[1]+h]).range([0,i]),d.current.y.domain([f[0]-g,f[1]+g]).range([s,0]),u.current.append("g").attr("transform",`translate(0,${s})`).call(n.axisBottom(d.current.x)),u.current.append("g").call(n.axisLeft(d.current.y));let p=()=>{let e=u.current.select(".overlay").node();return[n.event.sourceEvent.clientX-e.getBoundingClientRect().x,n.event.sourceEvent.clientY-e.getBoundingClientRect().y]},m=n.brush().extent([[0,0],[i,s]]).on("start",()=>{r=p(),u.current.selectAll(".selection").remove("rect")}).on("brush",()=>{a=p(),u.current.selectAll(".selected-area").remove(".selected-area"),u.current.selectAll(".selection").remove("rect");let e=Math.min(r[0],a[0]),t=Math.min(r[1],a[1]);u.current.append("rect").attr("class","selected-area").attr("position","absolute").attr("x",e).attr("y",t).attr("width",Math.abs(a[0]-r[0])).attr("height",Math.abs(a[1]-r[1])).attr("fill","rgba(130, 130, 130, 0.5)")}).on("end",()=>{a=p(),u.current.selectAll(".selected-area").remove(".selected-area"),u.current.selectAll(".selection").remove("rect");let e=Math.min(r[0],a[0]),t=Math.min(r[1],a[1]),i=u.current.append("rect").attr("class","selected-area").attr("position","absolute").attr("x",e).attr("y",t).attr("width",Math.abs(a[0]-r[0])).attr("height",Math.abs(a[1]-r[1])).attr("fill","rgba(140, 140, 140, 0.5)");c(),setTimeout(()=>{i.remove()},20)});u.current.append("g").call(m)},100)},[t.layout]),(0,i.useEffect)(()=>{setTimeout(()=>{let e=l.current.getBoundingClientRect(),r=e.width-40-30,a=e.height-10-20,{data:i}=t;0!==t.filters.length&&(i=t.filterData);let s=10**(-4+Math.round(Math.log10(i.length))),c=n.scaleLinear().domain([0,s]).range(["white","#4682b4"]),o=n.contourDensity().x(e=>d.current.x(e[t.fields.x])).y(e=>d.current.y(e[t.fields.y])).size([r,a]).bandwidth(20)(i);u.current.select("#draw_area").remove("g"),u.current.insert("g","g").attr("id","draw_area").selectAll("path").data(o).enter().append("path").attr("d",n.geoPath()).attr("fill",e=>c(e.value))},100)},[t.layout,t.filters,t.filterData]),e(i).createElement("div",{id:t.id,ref:l,role:"figure",style:{width:"100%",height:"100%"}})}var d=u;u.propTypes={data:e(l).arrayOf(e(l).shape({})).isRequired,fields:e(l).shape({x:e(l).string.isRequired,y:e(l).string.isRequired}).isRequired,id:e(l).string.isRequired,filterData:e(l).arrayOf(e(l).shape({})).isRequired,filters:e(l).arrayOf(e(l).shape({})).isRequired,layout:e(l).shape({width:e(l).number.isRequired,currentCols:e(l).number.isRequired}).isRequired,filterAdded:e(l).func.isRequired,title:e(l).string.isRequired}});
//# sourceMappingURL=DensityChart.cfae7461.js.map
