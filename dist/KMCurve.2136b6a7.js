var t=globalThis.parcelRequire94c2;(0,t.register)("3qdiD",function(e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=void 0;var a,o=f(t("acw62")),i=f(t("9NlP8")),u=(a=t("c9Z8w"))&&a.__esModule?a:{default:a};function l(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(l=function(t){return t?r:e})(t)}function f(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=n(t)&&"function"!=typeof t)return{default:t};var r=l(e);if(r&&r.has(t))return r.get(t);var a={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if("default"!==i&&({}).hasOwnProperty.call(t,i)){var u=o?Object.getOwnPropertyDescriptor(t,i):null;u&&(u.get||u.set)?Object.defineProperty(a,i,u):a[i]=t[i]}return a.default=t,r&&r.set(t,a),a}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function s(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(s=function(){return!!t})()}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function y(t){return void 0===t||null==t||"string"==typeof t&&"na"===t.toLowerCase()}var m=e.exports.default=function(t){var e;function r(t){var e,a,i;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),a=r,i=[t],a=p(a),(e=function(t,e){if(e&&("object"==n(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,s()?Reflect.construct(a,i||[],p(this).constructor):a.apply(this,i))).self=o.default.createRef(),e.maxTime=Number.NEGATIVE_INFINITY,e.state={margin:{top:35,right:20,bottom:45,left:45}},e.props.filter?e.state.data=e.transform(e.props.data.filter(function(t){return t[e.props.filter.field]===e.props.filter.value}),e.props.fields):e.state.data=e.transform(e.props.data,e.props.fields),e}return!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}(r,t),e=[{key:"componentDidMount",value:function(){var t=this;setTimeout(function(){var e=t.self.current.getBoundingClientRect(),r=e.width-t.state.margin.left-t.state.margin.right,n=e.height-t.state.margin.top-t.state.margin.bottom,a=i.select(t.self.current).append("svg").attr("width",e.width).attr("height",e.height),o=a.append("g").attr("transform","translate(".concat(t.state.margin.left,",").concat(t.state.margin.top,")"));t.xScale=i.scaleLinear().domain([0,t.maxTime]).range([0,r]),t.yScale=i.scaleLinear().domain([0,1]).range([n,0]),t.color=i.scaleOrdinal().domain(t.state.data.map(function(t){return t.key})).range(i.quantize(function(t){return i.interpolateSpectral(t)},t.state.data.length)),o.append("g").attr("transform","translate(0,".concat(n,")")).call(i.axisBottom(t.xScale).ticks(4)).append("text").attr("y",30).attr("x",r/2).attr("fill","black").attr("font-size",13).text("Time ".concat(t.props.fields.time.unit?"(".concat(t.props.fields.time.unit,")"):"")),o.append("g").call(i.axisLeft(t.yScale).ticks(4)).append("text").attr("y",-30).attr("x",-n/3).attr("fill","black").attr("font-size",13).attr("transform","rotate(-90)").text("Survival Probability"),t.state.data.forEach(function(e){return t.drawKMCurve(o,e)});var u=a.append("g").attr("class","legend").attr("transform","translate(".concat(t.state.margin.left+r/2,",0)")).selectAll("g").data(t.state.data).enter().append("g").attr("transform",function(t,e){return"translate(".concat(100*e,",").concat(15,")")});u.append("rect").style("fill",function(e){return t.color(e.key)}).attr("x",0).attr("y",0).attr("width",10).attr("height",10),u.append("text").style("font-family","Georgia").style("font-size","13px").attr("x",17.5).attr("y",10).text(function(t){return t.key});var l=0;u.attr("transform",function(){var t=l;return l+=this.getBBox().width+10,"translate(".concat(t,",").concat(10,")")})},500)}},{key:"transform",value:function(t,e){var r,n=e.eventValue,a=e.censoredValue,o=e.group.field,u=e.time.field,l=e.event.field,f=t.filter(function(t){return"stage_x/NR"!==t.collapsed_stage&&!y(t[u])&&!y(t[l])&&!y(t[o])});this.maxTime=Math.max.apply(Math,function(t){if(Array.isArray(t))return c(t)}(r=f.map(function(t){return t[u]}))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||function(t,e){if(t){if("string"==typeof t)return c(t,void 0);var r=({}).toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,void 0):void 0}}(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());var s=i.nest().key(function(t){return t[o]}).entries(f),p=[];return s.forEach(function(t){var e=t.key,r=t.values.length,o=i.nest().key(function(t){return+t[u]}).sortKeys(function(t,e){return+t-+e}).rollup(function(t){return{event:t.filter(function(t){return t[l]===n}).length,censor:t.filter(function(t){return t[l]===a}).length}}).entries(t.values),f=1,c=[];o.forEach(function(t){var e=+t.key,n=t.value.event,a=t.value.censor;e<0||(n>0&&(f*=1-n/r,c.push({p:f,currentTime:e,censored:!1})),a>0&&c.push({p:f,currentTime:e,censored:!0}),r-=n+a)}),p.push({key:e,points:c})}),p}},{key:"drawLine",value:function(t,e,r){var n=this,a=i.line().curve(i.curveStepAfter).x(function(t){return n.xScale(t.time)}).y(function(t){return n.yScale(t.p)});t.append("path").datum(e).attr("class","line").style("stroke",r).attr("d",a),e.forEach(function(e){if(e.censored){var n=[{p:e.p-.015,time:e.time},{p:e.p+.015,time:e.time}];t.append("path").datum(n).attr("class","mark").style("stroke",r).attr("d",a)}})}},{key:"drawKMCurve",value:function(t,e){this.drawLine(t,e.points,this.color(e.key))}},{key:"render",value:function(){return o.default.createElement("div",{id:this.props.id,ref:this.self,role:"figure",style:{width:"100%",height:"100%"}})}}],function(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,e||"default");if("object"!=n(a))return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}(a.key),a)}}(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}(o.PureComponent);m.propTypes={data:u.default.arrayOf(u.default.shape({})).isRequired,fields:u.default.shape({x:u.default.string.isRequired,time:u.default.shape()}).isRequired,filter:u.default.shape({field:u.default.string,value:u.default.string}),id:u.default.string.isRequired},m.defaultProps={filter:{}}});
//# sourceMappingURL=KMCurve.2136b6a7.js.map
